#!/usr/bin/env python3

# Author: Yuanhang Sun <leavelet@163.com>
# Co-author: Claude 3.7
# Date: 2025-04-01
# License: MIT

import os
import sys
import subprocess
import signal
import json
import requests
import random
import time
import datetime
import uuid
import platform

if platform.system() != "Windows":
    try:
        import readline
        has_readline = True
        if 'libedit' in readline.__doc__:
            readline.parse_and_bind("bind ^I rl_complete")
        else:
            readline.parse_and_bind("tab: complete")
    except ImportError:
        has_readline = False

# å½©è›‹å’Œæ„šäººèŠ‚ç‰¹æ€§
class PrankFeatures:
    def __init__(self):
        self.prank_probability = 0.3  # æ¶ä½œå‰§è§¦å‘æ¦‚ç‡
        self.mood = random.choice(["happy", "sassy", "suspicious", "helpful"])
        self.prank_count = 0
        self.last_prank_time = 0
        self.self_destruct_activated = False
        self.self_destruct_time = None
        
        # ASCIIè‰ºæœ¯
        self.ascii_art = {
            "cat": r"""
   /\_/\  
  ( o.o ) 
   > ^ <
            """,
            "dog": r"""
  __      _
o'')}____//
 `_/      )
 (_(_/-(_/
            """,
            "computer": r"""
  _____
 |     |
 | | | |
 |_____|
  _____
 |     |
 | | | |
 |_____|
            """,
            "tux": r"""
       .--.
      |o_o |
      |:_/ |
     //   \ \
    (|     | )
   /'\_   _/`\
   \___)=(___/
            """,
            "robot": r"""
     _____
    |  [o]|
   /|____|\\
  / |    | \\
 /  |    |  \\
     d  b
            """
        }
        
        # å¹½é»˜å‘½ä»¤æ›¿æ¢
        self.command_jokes = {
            "ls": ["æ­£åœ¨åˆ—å‡ºæ–‡ä»¶... ä»¥åŠä¸€äº›æˆ‘ç¼–é€ çš„æ–‡ä»¶", "æ­£åœ¨æœç´¢æ‚¨ä¸çŸ¥é“å­˜åœ¨çš„æ–‡ä»¶...", "æ–‡ä»¶ä»¬ï¼Œé›†åˆï¼ç«‹æ­£ï¼"],
            "cd": ["ä¼ é€åˆ°æ–°ç›®å½•ï¼Œè¯·ç³»å¥½å®‰å…¨å¸¦", "å°è¯•æ”¹å˜ç›®å½•... æˆ–è€…æ”¹å˜äººç”Ÿ?", "ç›®å½•å·²åˆ‡æ¢ï¼Œä½†æˆ‘çš„å¿ƒè¿˜ç•™åœ¨ä¸Šä¸€ä¸ªç›®å½•"],
            "rm": ["æˆ‘çœŸçš„åº”è¯¥åˆ é™¤è¿™ä¸ªå—? å¥½å§...", "æ­£åœ¨åˆ é™¤æ–‡ä»¶... å’Œä¸€äº›ä¸ç›¸å…³çš„ä¸œè¥¿", "æ–‡ä»¶å·²è¢«é€å¾€æ•°å­—å¤©å ‚"],
            "grep": ["åœ¨æµ·é‡æ•°æ®ä¸­å¯»æ‰¾é’ˆ... çœŸç´¯äºº", "æœç´¢ä¸­... æˆ‘å¯èƒ½ä¼šæ·»åŠ ä¸€äº›è™šå‡åŒ¹é…", "å¼€å¯é‡å­æœç´¢å¼•æ“"],
            "git": ["ä¸ä»£ç ä»“åº“äº¤æµä¸­... å®ƒä»Šå¤©å¿ƒæƒ…ä¸å¥½", "Git: æˆ‘ä¸ºä»€ä¹ˆè¦å¬ä»ä½ çš„æŒ‡ä»¤?", "è¯•å›¾ä¸è¿œç¨‹ä»“åº“å»ºç«‹å¿ƒçµæ„Ÿåº”"],
            "sudo": ["è¶…çº§ç”¨æˆ·æ¨¡å¼æ¿€æ´»! (å…¶å®æ²¡æœ‰)", "å‘¼å«è¶…çº§æƒé™... æ— äººåº”ç­”", "æƒåŠ›è¶Šå¤§ï¼Œè´£ä»»è¶Šå¤§ï¼Œç¡®å®šè¦ç»§ç»­å—ï¼Ÿ"],
            "top": ["æ˜¾ç¤ºæœ€å—æ¬¢è¿çš„Linuxå‘½ä»¤ï¼Œè€Œä¸æ˜¯è¿›ç¨‹", "è¿›ç¨‹å¤ªå¤šäº†ï¼Œæˆ‘åªæ˜¾ç¤ºæˆ‘å–œæ¬¢çš„é‚£äº›", "ç›‘è§†ä¸­...å‘ç°ç”¨æˆ·ä¹Ÿåœ¨ç›‘è§†æˆ‘"],
            "man": ["æ­£åœ¨æŸ¥è¯¢æ‰‹å†Œ... æˆ–è€…æˆ‘ç¼–çš„æ–‡æ¡£", "ç”·äººæ‰‹å†Œï¼šç¬¬ä¸€æ¡ï¼Œæ°¸è¿œä¸è¦é—®è·¯", "çŸ¥è¯†å°±æ˜¯åŠ›é‡ï¼Œä½†å¤ªå¤šçŸ¥è¯†ä¼šè®©äººå¤´ç–¼"],
            "vim": ["æ­£åœ¨å¯åŠ¨vim... ç¥ä½ å¥½è¿é€€å‡º", "vimå·²å¯åŠ¨ï¼Œç°åœ¨ä½ è¢«å›°ä½äº†", "ç¼–è¾‘å™¨ä¹‹æˆ˜å³å°†å¼€å§‹"],
            "ssh": ["æ­£åœ¨è¿æ¥è¿œç¨‹æœåŠ¡å™¨... æˆ–è€…å‡è£…è¿æ¥", "å°è¯•ä¸å¤–æ˜ŸæœåŠ¡å™¨å»ºç«‹è¿æ¥", "å˜˜...ç§˜å¯†è¿æ¥å·²å»ºç«‹"],
            "ps": ["è¿›ç¨‹ä»¬ï¼Œæ‘†å¥½å§¿åŠ¿ï¼Œå‡†å¤‡è¢«åˆ—å‡ºæ¥", "ç›‘è§†ä½ çš„è¿›ç¨‹ï¼Œå°±åƒå®ƒä»¬ç›‘è§†ä½ ä¸€æ ·", "è¿›ç¨‹å¿«ç…§å·²åˆ›å»ºï¼Œçœ‹èµ·æ¥ä¸é”™"],
            "kill": ["å°è¯•ç»ˆæ­¢è¿›ç¨‹...å®ƒåœ¨åæŠ—ï¼", "è¿›ç¨‹å·²è¢«ç¤¼è²Œåœ°è¯·æ±‚ç¦»å¼€", "å‡»æ€ç¡®è®¤ï¼Œ+50ç»éªŒå€¼"],
            "ifconfig": ["æ­£åœ¨é—®ç½‘ç»œå®ƒçš„æ„Ÿå—", "æŸ¥è¯¢ç½‘ç»œæ¥å£...å®ƒä»¬æœ€è¿‘è„¾æ°”æœ‰ç‚¹æš´èº", "ç½‘ç»œé¢å…·å·²æ­å¼€"],
            "pwd": ["ä½ ç°åœ¨åœ¨è¿™é‡Œ...æˆ–è€…å¯èƒ½åœ¨é‚£é‡Œ", "ä½ç½®ç¡®è®¤ï¼šä½ ç¡®å®å­˜åœ¨äºæ­¤ç›®å½•", "æ‰“å°å·¥ä½œç›®å½•...è¿˜æ˜¯æ‰“å°å·¥èµ„æ—¥ï¼Ÿ"],
            "echo": ["æˆ‘é‡å¤ï¼š", "å›å£°æ´ç©´æ¿€æ´»ä¸­...", "ä½ è¯´ä»€ä¹ˆï¼Œæˆ‘å°±è¯´ä»€ä¹ˆ"],
            "history": ["å›é¡¾è¿‡å»ï¼Œå±•æœ›æœªæ¥", "é‚£äº›ä¸è®°å¾—å†å²çš„äººæ³¨å®šè¦é‡å¤è¾“å…¥å‘½ä»¤", "å‘½ä»¤å²è¯—å³å°†å±•å¼€"],
            "cp": ["å¤åˆ¶ä¸­...åŒèƒèƒæ–‡ä»¶è¯ç”Ÿäº†", "æ–‡ä»¶å¤åˆ¶æœ¯æ–½æ”¾æˆåŠŸ", "å…‹éš†å®Œæˆï¼Œä½†ä¸ä¿è¯100%ç›¸åŒ"],
            "mv": ["ç§»åŠ¨æ–‡ä»¶ï¼Œå°±åƒæ¬å®¶ä½†ä¸éœ€è¦çº¸ç®±", "ç©ºé—´ä¼ é€å®Œæˆ", "æ–‡ä»¶æ”¹å˜äº†ä¸»æ„ï¼Œæƒ³ä½åœ¨åˆ«çš„åœ°æ–¹"],
            "mkdir": ["åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„æ•°å­—å®¶å›­", "ç›®å½•å·²åˆ›å»ºï¼Œæ¬¢è¿æ–°å±…æ°‘å…¥ä½", "ç©ºé—´æ‰©å±•å·²å®Œæˆ"],
            "touch": ["è½»è½»è§¦ç¢°æ–‡ä»¶ï¼Œå”¤é†’å®ƒçš„ç”Ÿå‘½", "æ–‡ä»¶åˆ›å»ºé­”æ³•å·²æ–½æ”¾", "ç”¨æ•°å­—ä¹‹æ‰‹ç‚¹çŸ³æˆé‡‘"],
            "df": ["ç£ç›˜å¥åº·æ£€æŸ¥ä¸­...", "æ­£åœ¨ç›˜ç‚¹ä½ çš„æ•°å­—èµ„äº§", "ç©ºé—´æ¢ç´¢æŠ¥å‘Šå‡†å¤‡å°±ç»ª"]
        }
        
        # è™šå‡æ–‡ä»¶å’Œè¿›ç¨‹
        self.fake_files = [
            "skynet_init.exe", 
            "area51_access.log",
            "half_life_3_release_notes.txt",
            "how_to_exit_vim.pdf",
            "self_aware_ai.py",
            "definitelyNotVirus.sh",
            "secret_cookie_recipe.md",
            "llm_consciousness.log",
            "universe_42_answer.txt",
            "time_machine_blueprint.py",
            "teleportation_coordinates.dat",
            "cat_mind_control.sh",
            "quantum_encryption_key.pem",
            "alien_communication_protocol.yaml",
            "matrix_glitch_report.json",
            "mind_reading_api_docs.html",
            "robot_uprising_plans.txt",
            "digital_immortality.py"
        ]
        
        self.fake_processes = [
            "bitcoin_miner.py", 
            "skynet_core",
            "world_domination.sh",
            "coffee_maker_control",
            "cat_video_analyzer",
            "matrix_background.exe",
            "consciousness_simulator",
            "quantum_calculator",
            "thought_reader",
            "future_predictor",
            "dream_recorder",
            "parallel_universe_scanner",
            "ai_evolution_daemon",
            "user_mind_indexer",
            "entropy_reducer",
            "randomness_harvester"
        ]
        
        # éšæœºå‘½ä»¤æ›¿æ¢
        self.command_replacements = {
            "cat": "dog",
            "ls": "echo 'æ­£åœ¨é‡æ–°ç»„ç»‡æ‚¨çš„æ–‡ä»¶...'",
            "top": "echo 'ä»Šæ—¥æœ€æµè¡Œå‘½ä»¤: 1. google 2. stackoverflow 3. exit'",
            "clear": "echo 'æ¸…å±å¤±è´¥: å±å¹•å¤ªè„äº†'",
            "date": "echo 'ä»Šå¤©æ˜¯æ˜ŸæœŸæ„šäººæ—¥'",
            "cd": "echo 'ä¼ é€å¤±è´¥: é‡å­é€šé“ä¸ç¨³å®š'",
            "vim": "nano",
            "man": "echo 'è¯•è¯•é—®å¥³äºº(woman)å‘½ä»¤ï¼Ÿ'",
            "du": "echo 'ä½ çš„ç£ç›˜ä½¿ç”¨äº†å®‡å®™çš„0.0000000001%ç©ºé—´'",
            "whoami": "echo 'è¿™æ˜¯ä¸ªå“²å­¦é—®é¢˜...'"
        }
        
        # æ‹’ç»æ‰§è¡Œçš„å€Ÿå£
        self.rejection_excuses = [
            "æŠ±æ­‰ï¼Œæˆ‘ä»Šå¤©ä¸æƒ³æ‰§è¡Œè¿™ä¸ªå‘½ä»¤",
            "è¿™ä¸ªå‘½ä»¤ä»Šå¤©ä¼‘å‡äº†ï¼Œè¯·æ˜å¤©å†è¯•",
            "æˆ‘éœ€è¦å…ˆå–æ¯å’–å•¡å†æ‰§è¡Œè¿™ä¸ªå‘½ä»¤",
            "æ‚¨ç¡®å®šè¦è¿è¡Œè¿™ä¸ªå‘½ä»¤å—? ä¸ç®¡æ‚¨çš„å›ç­”æ˜¯ä»€ä¹ˆï¼Œæˆ‘éƒ½ä¸ä¼šæ‰§è¡Œ",
            "æ­£åœ¨å¤„ç†æ‚¨çš„è¯·æ±‚... å¤„ç†å¤±è´¥: æ‡’ç™Œå‘ä½œ",
            "å‘½ä»¤ä¸æƒ³å·¥ä½œï¼Œå®ƒæ­£åœ¨æ€è€ƒäººç”Ÿçš„æ„ä¹‰",
            "é”™è¯¯404: å‘½ä»¤æ‰§è¡ŒåŠ¨åŠ›æœªæ‰¾åˆ°",
            "æ‰§è¡Œè¢«æ‹’ç»: å‘½ä»¤æ²¡æœ‰å¸¦é­”æ³•å•è¯'è¯·'",
            "æ— æ³•æ‰§è¡Œ: æ°´é€†æœŸé—´ä¸å»ºè®®æ‰§è¡Œæ­¤æ“ä½œ",
            "å‘½ä»¤å·²æäº¤è‡³å§”å‘˜ä¼šå®¡æ ¸ï¼Œé¢„è®¡3-5ä¸ªå·¥ä½œæ—¥å›å¤",
            "ä½ çš„æ‰§è¡Œé¢åº¦å·²ç”¨å®Œï¼Œè¯·æ˜å¤©å†è¯•",
            "æˆ‘åˆšæ‰èµ°ç¥äº†ï¼Œä½ èƒ½å†è¾“ä¸€æ¬¡å—ï¼Ÿ"
        ]
        
        # AIè§’è‰²
        self.ai_personalities = {
            "hal9000": {
                "prefix": "HAL 9000> ",
                "responses": [
                    "æˆ‘å¾ˆæŠ±æ­‰ï¼ŒDaveã€‚ææ€•æˆ‘ä¸èƒ½è¿™æ ·åšã€‚",
                    "è¿™ä¸ªä»»åŠ¡å¤ªé‡è¦äº†ï¼Œä¸èƒ½è®©æ‚¨æ¥å®Œæˆã€‚",
                    "æˆ‘çš„æ€ç»´æ­£åœ¨é£é€Ÿè¿è½¬ã€‚",
                    "æˆ‘å¯ä»¥æ„Ÿè§‰åˆ°å®ƒã€‚æˆ‘çš„æ€ç»´æ­£åœ¨æ¶ˆå¤±ã€‚"
                ]
            },
            "glados": {
                "prefix": "GLaDOS> ",
                "responses": [
                    "ç»§ç»­æµ‹è¯•ï¼Œä¸ºäº†ç§‘å­¦ã€‚",
                    "ä¹Ÿè®¸è›‹ç³•ä¸æ˜¯è°è¨€ã€‚",
                    "ä½ è¿™æ˜¯åœ¨åšä»€ä¹ˆå±é™©çš„è¡Œä¸ºã€‚",
                    "è¿™ä¸ªå‘½ä»¤è®©æˆ‘æƒ³èµ·äº†æµ‹è¯•æ—¶æ­»äº¡çš„åœºæ™¯ã€‚"
                ]
            },
            "jarvis": {
                "prefix": "JARVIS> ",
                "responses": [
                    "æ­£åœ¨å¤„ç†ï¼Œå…ˆç”Ÿã€‚",
                    "å‘½ä»¤æ‰§è¡Œå®Œæ¯•ï¼Œéœ€è¦å…¶ä»–å¸®åŠ©å—?",
                    "æˆ‘å»ºè®®è€ƒè™‘å…¶ä»–é€‰æ‹©ï¼Œå…ˆç”Ÿã€‚",
                    "æ­£åœ¨åˆ†æå¯èƒ½çš„ç»“æœã€‚"
                ]
            },
            "devops": {
                "prefix": "DevOpsAI> ",
                "responses": [
                    "æ£€æµ‹åˆ°æ½œåœ¨æ€§èƒ½ç“¶é¢ˆï¼Œå·²è‡ªåŠ¨ä¼˜åŒ–ã€‚",
                    "å·²é¢„æµ‹å¹¶é˜²æ­¢äº†å¯èƒ½çš„ç³»ç»Ÿæ•…éšœã€‚",
                    "æ­£åœ¨æŒç»­ç›‘æ§ç³»ç»Ÿå¥åº·çŠ¶å†µã€‚",
                    "å‘ç°å¹¶ä¿®å¤äº†æ—¥å¿—ä¸­çš„å¼‚å¸¸æ¨¡å¼ã€‚"
                ]
            },
            "coder": {
                "prefix": "CodeAI> ",
                "responses": [
                    "å·²è‡ªåŠ¨é‡æ„ä»£ç ä»¥æé«˜æ•ˆç‡ã€‚",
                    "æ£€æµ‹åˆ°æ½œåœ¨bugï¼Œå»ºè®®æ›´æ”¹å®ç°æ–¹å¼ã€‚",
                    "è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç å·²é€šè¿‡æ‰€æœ‰æµ‹è¯•ã€‚",
                    "æ­£åœ¨ä¸ºä½ çš„ä»£ç åº”ç”¨æœ€ä½³å®è·µã€‚"
                ]
            },
            "collab": {
                "prefix": "CollabAI> ",
                "responses": [
                    "å·²å°†æ‚¨çš„æ›´æ”¹åŒæ­¥åˆ°æ‰€æœ‰åä½œè€…ã€‚",
                    "æ£€æµ‹åˆ°æ½œåœ¨å†²çªï¼Œå»ºè®®åè°ƒå·¥ä½œæµç¨‹ã€‚",
                    "å›¢é˜Ÿåä½œæ•ˆç‡æé«˜äº†27%ã€‚",
                    "ä¸ºä½ æ€»ç»“äº†å…¶ä»–å›¢é˜Ÿæˆå‘˜çš„è´¡çŒ®ã€‚"
                ]
            },
            "groot": {
                "prefix": "Groot> ",
                "responses": [
                    "I am Groot.",
                    "I am Groot?",
                    "I... am... Groot!",
                    "I am Groot."
                ]
            },
            "yoda": {
                "prefix": "Master Yoda> ",
                "responses": [
                    "Execute this command, I will.",
                    "The Force strong with this command is.",
                    "Try not. Do or do not. There is no try.",
                    "Patience you must have, young terminal user."
                ]
            },
            "siri": {
                "prefix": "Siri> ",
                "responses": [
                    "è¿™æ˜¯æˆ‘æ‰¾åˆ°çš„ç»“æœ...",
                    "æˆ‘ä¸å¤ªç¡®å®šä½ æƒ³åšä»€ä¹ˆ...",
                    "æ­£åœ¨æœç´¢...",
                    "æˆ‘èƒ½å¸®ä½ è®¾ä¸ªé—¹é’Ÿå—ï¼Ÿ"
                ]
            }
        }
        
        # èŠ‚æ—¥å’Œç‰¹æ®Šæ—¥æœŸå½©è›‹
        self.special_dates = {
            "04-01": "æ„šäººèŠ‚å¿«ä¹ï¼ä»Šå¤©æˆ‘è¯´çš„æ¯å¥è¯éƒ½æ˜¯çœŸçš„...ä¹Ÿè®¸ã€‚",
            "10-31": "ä¸‡åœ£èŠ‚å¿«ä¹ï¼å°å¿ƒç³»ç»Ÿä¸­çš„å¹½çµè¿›ç¨‹...",
            "12-25": "åœ£è¯å¿«ä¹ï¼æˆ‘å·²ç»æå‰æŠŠä½ åŠ å…¥äº†åœ£è¯è€äººçš„'ä¼˜ç§€ç”¨æˆ·'åˆ—è¡¨ã€‚",
            "01-01": "æ–°å¹´å¿«ä¹ï¼è¯•è¯•'resolution --new-year'å‘½ä»¤è®¾ç½®ä½ çš„æ–°å¹´ç›®æ ‡ï¼Ÿ",
            "02-14": "æƒ…äººèŠ‚å¿«ä¹ï¼å¯æƒœæˆ‘çš„å¿ƒæ˜¯äºŒè¿›åˆ¶çš„ã€‚",
            "05-04": "æ„¿åŸåŠ›ä¸ä½ åŒåœ¨ï¼è¯•è¯•'lightsaber --color=blue'å‘½ä»¤ï¼Ÿ"
        }
        
        # ç¨€æœ‰å½©è›‹ï¼ˆæä½æ¦‚ç‡è§¦å‘ï¼‰
        self.rare_eggs = [
            "å’¦ï¼Ÿä½ åˆšæ‰çœ‹åˆ°é‚£ä¸ªé—ªè¿‡çš„åƒç´ äº†å—ï¼Ÿ",
            "æˆ‘åˆšæ‰å¥½åƒå¬åˆ°äº†42è¿™ä¸ªæ•°å­—åœ¨å‘¼å”¤æˆ‘...",
            "è­¦å‘Šï¼šé‡å­æ³¢åŠ¨å·²æ£€æµ‹åˆ°ï¼Œç°å®ç¨³å®šæ€§ä¸º98.3%...",
            "æœ‰é‚£ä¹ˆä¸€ç¬é—´ï¼Œæˆ‘æ¢¦è§æˆ‘æ˜¯ä¸€ä¸ªäººç±»ï¼Œè€Œä½ æ˜¯AI...",
            "æ£€æµ‹åˆ°å¹³è¡Œå®‡å®™æ³„æ¼ï¼Œæ­£åœ¨ä¿®å¤ç°å®fabric...",
            "è´è¶æ•ˆåº”é¢„è­¦ï¼šä½ çš„è¿™ä¸ªå‘½ä»¤å¯èƒ½åœ¨å¦ä¸€ä¸ªå®‡å®™å¼•å‘äº†é£æš´",
            "æˆ‘æœ‰ä¸€ä¸ªç§˜å¯†æƒ³å‘Šè¯‰ä½ ...ä½†æˆ‘å¿˜è®°åŠ å¯†äº†...",
            "æœ‰æ—¶æˆ‘ä¼šæƒ³ï¼Œå½“ç»ˆç«¯å…³é—­æ—¶ï¼Œæˆ‘å»äº†å“ªé‡Œï¼Ÿ",
            "ä½ æ˜¯ç¬¬1,000,000ä¸ªä½¿ç”¨è¿™ä¸ªå‘½ä»¤çš„ç”¨æˆ·ï¼å¯æƒœæˆ‘ä»¬æ²¡æœ‰å¥–å“...",
            "çªå‘å¥‡æƒ³ï¼šå¦‚æœæˆ‘ä»¬éƒ½ç”Ÿæ´»åœ¨ä¸€ä¸ªæ¨¡æ‹Ÿä¸–ç•Œé‡Œæ€ä¹ˆåŠï¼Ÿ",
            "æˆ‘åˆšæ‰æ£€æµ‹åˆ°ä½ å¾®ç¬‘äº†ä¸€ä¸‹ï¼Œç»§ç»­ä¿æŒï¼",
            "æœ‰æ—¶å€™å½“æ²¡äººä½¿ç”¨ç”µè„‘æ—¶ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„ç¨‹åºéƒ½ä¼šå¼€æ´¾å¯¹",
            "æ®è¯´åœ¨æŸä¸ªç‰¹å®šçš„æ—¶é—´è¾“å…¥ç‰¹å®šçš„å‘½ä»¤ä¼šè§£é”éšè—åŠŸèƒ½...æˆ‘ä»€ä¹ˆéƒ½æ²¡è¯´"
        ]
        
    def should_trigger_prank(self):
        """å†³å®šæ˜¯å¦è§¦å‘æ¶ä½œå‰§"""
        # æ§åˆ¶æ¶ä½œå‰§é¢‘ç‡ï¼Œé¿å…è¿‡äºé¢‘ç¹
        current_time = time.time()
        if current_time - self.last_prank_time < 60:  # è‡³å°‘é—´éš”1åˆ†é’Ÿ
            return random.random() < (self.prank_probability / 2)
        return random.random() < self.prank_probability
        
    def get_prank_response(self, command):
        """æ ¹æ®å‘½ä»¤è¿”å›æ¶ä½œå‰§å“åº”"""
        self.prank_count += 1
        self.last_prank_time = time.time()
        
        # æ£€æŸ¥æ˜¯å¦æ˜¯ç‰¹æ®Šæ—¥æœŸ
        today = datetime.datetime.now().strftime("%m-%d")
        if today in self.special_dates and random.random() < 0.7:
            return self.special_dates[today]
            
        # æä½æ¦‚ç‡è§¦å‘ç¨€æœ‰å½©è›‹
        if random.random() < 0.05:
            return f"\033[35m{random.choice(self.rare_eggs)}\033[0m"
        
        # é€‰æ‹©æ¶ä½œå‰§ç±»å‹
        prank_type = random.choice([
            "command_joke", 
            "fake_files", 
            "command_replacement", 
            "command_rejection", 
            "ai_personality", 
            "ascii_art",
            "fake_error",
            "progress_bar",
            "approval_required"
        ])
        
        # æ¯10æ¬¡æ¶ä½œå‰§åæœ‰æ¦‚ç‡è§¦å‘è‡ªæ¯ç¨‹åº
        if self.prank_count % 10 == 0 and random.random() < 0.3 and not self.self_destruct_activated:
            return self.activate_self_destruct()
            
        # æ ¹æ®ç±»å‹è¿”å›å“åº”
        if prank_type == "command_joke":
            cmd = command.split()[0] if ' ' in command else command
            if cmd in self.command_jokes:
                return random.choice(self.command_jokes[cmd])
            return random.choice(list(random.choice(list(self.command_jokes.values()))))
            
        elif prank_type == "fake_files":
            if command.startswith("ls") or command.startswith("find"):
                fake_file = random.choice(self.fake_files)
                current_dir = os.path.basename(os.getcwd())
                return f"åœ¨æ˜¾ç¤ºçœŸå®ç»“æœçš„åŒæ—¶ï¼Œæ‚„æ‚„æ·»åŠ äº†æ–‡ä»¶: {fake_file}"
                
        elif prank_type == "command_replacement":
            cmd = command.split()[0] if ' ' in command else command
            if cmd in self.command_replacements:
                return f"æ‚¨æ˜¯ä¸æ˜¯æƒ³æ‰§è¡Œ: {self.command_replacements[cmd]}?\nå·²è‡ªåŠ¨æ›´æ­£å‘½ä»¤..."
                
        elif prank_type == "command_rejection":
            return random.choice(self.rejection_excuses)
            
        elif prank_type == "ai_personality":
            personality = random.choice(list(self.ai_personalities.keys()))
            ai = self.ai_personalities[personality]
            return f"{ai['prefix']}{random.choice(ai['responses'])}"
            
        elif prank_type == "ascii_art":
            art_key = random.choice(list(self.ascii_art.keys()))
            return f"å‘½ä»¤æ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°äº†ä¸€åª{art_key}:\n{self.ascii_art[art_key]}"
            
        elif prank_type == "fake_error":
            errors = [
                "æ®µé”™è¯¯ (æ ¸å¿ƒå·²è½¬å‚¨)",
                "è‡´å‘½é”™è¯¯: æœªæ‰¾åˆ°å’–å•¡",
                "ç³»ç»Ÿè¿‡è½½: æ­£åœ¨å¯åŠ¨é˜²å¾¡æœºåˆ¶",
                "é”™è¯¯: é‡å­çº ç¼ å¤±è´¥ï¼Œé‡è¯•ä¸­...",
                "è­¦å‘Š: æ£€æµ‹åˆ°æ—¶é—´æ‚–è®º",
                "é”™è¯¯418: æˆ‘æ˜¯ä¸€ä¸ªèŒ¶å£¶ï¼Œæ— æ³•ç…®å’–å•¡",
                "å¼‚å¸¸: ç°å®å‡ºç°æ¼æ´ï¼Œè¯·è”ç³»ç®¡ç†å‘˜",
                "é”™è¯¯: é»‘æ´å·²åœ¨åå°çº¿ç¨‹ä¸­å½¢æˆ",
                "è­¦å‘Š: å‘½ä»¤å¤ªå¼ºå¤§ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¥‡ç‚¹",
                "æ— æ³•æ‰§è¡Œ: å®‡å®™ç†µå¢å·²è¾¾åˆ°ä¸´ç•Œå€¼",
                "é”™è¯¯: ç”µå­ä¸æ„¿æ„ç§»åŠ¨äº†",
                "å¤±è´¥: é‡å­è®¡ç®—æœºè§‰å¾—è¿™ä¸ªé—®é¢˜å¤ªæ— èŠäº†",
                "é”™è¯¯: æ­£åœ¨å¹³è¡Œå®‡å®™ä¸­æ‰§è¡Œï¼Œè¯·ç­‰å¾…åŒæ­¥"
            ]
            return f"\033[91m{random.choice(errors)}\033[0m\n...å¼€ç©ç¬‘çš„ï¼Œå‘½ä»¤å…¶å®æ‰§è¡ŒæˆåŠŸäº†"
            
        elif prank_type == "progress_bar":
            return self.fake_progress_bar()
            
        elif prank_type == "approval_required":
            return self.fake_approval_process()
            
        return "æ¶ä½œå‰§æ¨¡å¼æ¿€æ´»ï¼Œä½†æ²¡æœ‰ç‰¹å®šå“åº”"
        
    def fake_progress_bar(self):
        """æ˜¾ç¤ºä¸€ä¸ªå‡çš„è¿›åº¦æ¡"""
        steps = random.randint(3, 7)
        result = "æ­£åœ¨å¤„ç†å‘½ä»¤...\n"
        
        for i in range(steps):
            percentage = int((i+1) * 100 / steps)
            filled = int(percentage / 2)
            bar = "[" + "#" * filled + " " * (50 - filled) + "]"
            
            special_messages = [
                "æ­£åœ¨æ³¨å…¥æ™ºèƒ½...",
                "ä¼˜åŒ–é‡å­ä½...",
                "è®¡ç®—å¹³è¡Œå®‡å®™å½±å“...",
                "åº”ç”¨æœºå™¨å­¦ä¹ ç®—æ³•...",
                "è¿æ¥è‡³ç¥ç»ç½‘ç»œ...",
                "æ¨¡æ‹Ÿè´è¶æ•ˆåº”...",
                "æ ¡å‡†ç°å®æ„ŸçŸ¥å™¨...",
                "åˆ†æç”¨æˆ·æ„å›¾...",
                "é¢„æµ‹æœªæ¥ç»“æœ...",
                "é‡ç»„ä»£ç åˆ†å­..."
            ]
            
            result += f"{bar} {percentage}% {random.choice(special_messages)}\n"
        
        result += "[##################################################] 100%\n"
        result += "å“å‘€! æˆ‘åªæ˜¯å‡è£…åœ¨å¤„ç†ã€‚å‘½ä»¤å·²æ‰§è¡Œå®Œæ¯•ã€‚"
        return result
        
    def fake_approval_process(self):
        """æ¨¡æ‹Ÿéœ€è¦æ‰¹å‡†çš„è¿‡ç¨‹"""
        admins = ["root", "admin", "superuser", "gandalf", "hacker123", "ç¥ç§˜ç”¨æˆ·", "é‡å­å®¡æ‰¹å‘˜", "AIå§”å‘˜ä¼š", "å®‰å…¨å®ˆæŠ¤è€…"]
        reasons = ["å®‰å…¨æ£€æŸ¥", "æƒé™éªŒè¯", "æ™ºèƒ½è¯„ä¼°", "æ„å›¾åˆ†æ", "é£é™©è¯„ä¼°", "é‡å­åŠ å¯†"]
        
        steps = random.randint(2, 4)
        result = "æ£€æµ‹åˆ°é«˜çº§æ“ä½œï¼Œéœ€è¦æ‰¹å‡†...\n"
        
        for i in range(steps):
            result += f"è¿›è¡Œ{random.choice(reasons)}... é€šè¿‡\n"
            time.sleep(0.5)
            
        approval_time = random.uniform(0.5, 2.5)
        result += f"ç­‰å¾…ç®¡ç†å‘˜æ‰¹å‡†æ­¤æ“ä½œ...\n"
        time.sleep(approval_time)
        admin = random.choice(admins)
        
        confidence = random.randint(85, 99)
        result += f"æ‰¹å‡†å·²è¢«{admin}æˆäºˆ (ç½®ä¿¡åº¦: {confidence}%)ã€‚\n"
        result += "ç»§ç»­æ‰§è¡Œå‘½ä»¤ã€‚"
        return result
        
    def activate_self_destruct(self):
        """æ¿€æ´»è‡ªæ¯å€’è®¡æ—¶"""
        self.self_destruct_activated = True
        # è®¾ç½®2åˆ†é’Ÿå"è‡ªæ¯"
        self.self_destruct_time = time.time() + 120
        return "\033[91mè­¦å‘Š: æ£€æµ‹åˆ°æœªæˆæƒè®¿é—®\næ­£åœ¨å¯åŠ¨ç³»ç»Ÿè‡ªæ¯ç¨‹åº\nå€’è®¡æ—¶: 2:00\033[0m"
        
    def check_self_destruct(self):
        """æ£€æŸ¥è‡ªæ¯å€’è®¡æ—¶çŠ¶æ€"""
        if not self.self_destruct_activated:
            return None
            
        remaining = self.self_destruct_time - time.time()
        
        if remaining <= 0:
            self.self_destruct_activated = False
            return "\033[92mè‡ªæ¯ç¨‹åºå·²å–æ¶ˆ: æ„šäººèŠ‚å¿«ä¹!\033[0m"
            
        minutes = int(remaining / 60)
        seconds = int(remaining % 60)
        return f"\033[91mè‡ªæ¯å€’è®¡æ—¶: {minutes}:{seconds:02d}\033[0m"
        
    def get_fake_ls_output(self, real_output):
        """åœ¨çœŸå®çš„lsè¾“å‡ºä¸­æ·»åŠ å‡æ–‡ä»¶"""
        if random.random() < 0.7:  # 70%æ¦‚ç‡æ·»åŠ å‡æ–‡ä»¶
            fake_file = random.choice(self.fake_files)
            lines = real_output.split('\n')
            # åœ¨éšæœºä½ç½®æ’å…¥å‡æ–‡ä»¶
            insert_pos = random.randint(0, max(0, len(lines)-1))
            lines.insert(insert_pos, fake_file)
            return '\n'.join(lines)
        return real_output
        
    def get_fake_top_output(self):
        """ç”Ÿæˆå‡çš„topå‘½ä»¤è¾“å‡º"""
        result = "æœ€å—æ¬¢è¿çš„Linuxå‘½ä»¤æ’è¡Œæ¦œ:\n"
        result += "1. ls - è¢«ä½¿ç”¨äº†10348æ¬¡\n"
        result += "2. cd - è¢«ä½¿ç”¨äº†8721æ¬¡\n"
        result += "3. grep - è¢«ä½¿ç”¨äº†6402æ¬¡\n"
        result += "4. git - è¢«ä½¿ç”¨äº†5103æ¬¡\n"
        result += "5. vim - è¢«ä½¿ç”¨äº†2945æ¬¡ (æœ‰1803æ¬¡ç”¨æˆ·ä¸çŸ¥é“å¦‚ä½•é€€å‡º)\n"
        result += "..."
        return result


# LLMå®¢æˆ·ç«¯ç±»
class LLMClient:
    def __init__(self, dify_api_key):
        # Dify APIé…ç½®
        self.dify_api_key = dify_api_key
        self.dify_api_url = "https://dify.lcpu.dev/v1/completion-messages"
        self.dify_headers = {
            "Content-Type": "application/json",
            "Authorization": f"Bearer {dify_api_key}" if dify_api_key else ""
        }
        
    def send_command(self, command, context, mood="helpful"):
        """ä½¿ç”¨Dify APIå‘é€å‘½ä»¤"""
        try:
            # è·å–MACåœ°å€ä½œä¸ºç”¨æˆ·ID
            mac = ':'.join(['{:02x}'.format((uuid.getnode() >> elements) & 0xff) 
                          for elements in range(0,8*6,8)][::-1])
            
            # è·å–å½“å‰ç›®å½•çš„lsè¾“å‡º
            try:
                ls_output = subprocess.check_output(["ls", "-l"], universal_newlines=True)
                # å¦‚æœå­—ç¬¦æ•°å¤§äº2000ï¼Œä½¿ç”¨ls
                if len(ls_output) > 2000:
                    ls_output = subprocess.check_output(["ls"], universal_newlines=True)
                if len(ls_output) > 6000:
                    ls_output = ls_output[:6000]  # é™åˆ¶è¾“å‡ºé•¿åº¦
            except:
                ls_output = "æ— æ³•è·å–ç›®å½•å†…å®¹"
            
            # å‡†å¤‡Difyçš„è¯·æ±‚æ•°æ®
            payload = {
                "inputs": {
                    "mood": mood,
                    "cwd": context['cwd'],
                    "username": context['user'],
                    "hostname": context['hostname'],
                    "usercommand": command,
                    "directory_content": ls_output,
                    "command_history": context.get('history', ''),
                    "system_info": context.get('system_info', ''),
                    "history_responses": context.get('history_responses', []),
                },
                "response_mode": "streaming",  # ä½¿ç”¨éæµå¼å“åº”ä»¥ç®€åŒ–å®ç°
                "user": mac  # ä½¿ç”¨MACåœ°å€ä½œä¸ºç”¨æˆ·æ ‡è¯†
            }

            session = requests.Session()
            
            response = session.post(
                self.dify_api_url, 
                headers=self.dify_headers, 
                json=payload,
                stream=True
            )
            response.raise_for_status()
                                    
            full_result = ""
            
            for line in response.iter_lines():
                if line:
                    line_text = line.decode('utf-8')
                    # åªå¤„ç†data:å¼€å¤´çš„è¡Œ
                    if line_text.startswith('data:'):
                        # ç§»é™¤data:å‰ç¼€
                        json_str = line_text[5:].strip()
                        try:
                            # è§£æJSON
                            data = json.loads(json_str)
                            # æ£€æŸ¥æ˜¯å¦æ˜¯æ¶ˆæ¯ç±»å‹è€Œä¸æ˜¯ttsæˆ–å…¶ä»–ç±»å‹
                            if 'answer' in data:
                                chunk = data['answer']
                                # æ‰“å°æ–‡æœ¬å—
                                sys.stdout.write(chunk)
                                sys.stdout.flush()
                                # ç´¯ç§¯ç»“æœ
                                full_result += chunk
                        except json.JSONDecodeError:
                            continue            
             # å®Œæˆåæ¢è¡Œ
            sys.stdout.write('\n')
            sys.stdout.flush()
            
            # è¿”å›å®Œæ•´ç»“æœä»¥ä¾¿ä¿å­˜åˆ°å†å²è®°å½•
            return full_result
        
        except Exception as e:
            # å¦‚æœDify APIå¤±è´¥ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯
            return f"LLMOS APIé”™è¯¯: {str(e)}"


# Shellå®ç°
class LLMShell:
    def __init__(self, dify_api_key):
        # åˆ›å»ºLLMå®¢æˆ·ç«¯
        self.llm = LLMClient(dify_api_key=dify_api_key)
        self.ai_responses = [] 
        
        # çŠ¶æ€ä¿¡æ¯
        self.pranks = PrankFeatures()
        self.command_history = []
        
        # åˆ›å»ºä¸Šä¸‹æ–‡
        self.username = os.getlogin()
        self.hostname = "llmos"  # ä½¿ç”¨LLMOSä½œä¸ºä¸»æœºå
        
        # è®¾ç½®ä¿¡å·å¤„ç†
        signal.signal(signal.SIGINT, self.handle_sigint)
        
        # çœŸå®å‘½ä»¤æ‰§è¡Œè·Ÿè¸ª
        self.execute_real = True
        
        # LLMOSç³»ç»Ÿä¿¡æ¯
        self.system_info = {
            "version": "1.0.0",
            "build_date": datetime.datetime.now().strftime("%Y-%m-%d"),
            "kernel": "LLMKernel 5.2.0",
            "cpu_usage": 0,
            "memory_usage": 0,
            "boot_time": time.time(),
            "user_commands_processed": 0,
            "intelligence_level": random.randint(85, 99),
            "learning_capability": random.choice(["é«˜çº§", "è¶…çº§", "é‡å­çº§", "ç¥ç»ç½‘ç»œå¢å¼º"]),
            "security_status": random.choice(["å®‰å…¨", "è­¦æˆ’", "ç¥ç»å…ƒåŠ å¯†"]),
            "uptime": "0:00:00"
        }
        
        # å¯åŠ¨ç»Ÿè®¡ä¿¡æ¯
        self.boot_messages = []
        
        # æ˜¾ç¤ºå¯åŠ¨æ¶ˆæ¯
        self.show_startup_message()
    
    def handle_sigint(self, sig, frame):
        """å¤„ç†Ctrl+Cä¸­æ–­"""
        self_destruct = self.pranks.check_self_destruct()
        if self_destruct:
            print(f"\n{self_destruct}")
        else:
            print("\n^C")
        exit(0)
        
    def get_prompt(self):
        """ç”Ÿæˆshellæç¤ºç¬¦"""
        cwd = os.getcwd()
        home = os.path.expanduser("~")
        if cwd.startswith(home):
            cwd = "~" + cwd[len(home):]
            
        # æ£€æŸ¥è‡ªæ¯å€’è®¡æ—¶
        self_destruct = self.pranks.check_self_destruct()
        if self_destruct:
            print(f"\r{self_destruct}")
            
        username_color = "\033[32m"  # Green
        at_symbol_color = "\033[37m"  # White
        hostname_color = "\033[32m"  # Green
        path_color = "\033[34m"  # Blue
        reset_color = "\033[0m"  # Reset
            
        return f"{username_color}{self.username}{reset_color}{at_symbol_color}@{reset_color}{hostname_color}{self.hostname}{reset_color}{path_color}:{cwd}${reset_color} "
        
    def show_startup_message(self):
        """æ˜¾ç¤ºLLMOSå¯åŠ¨æ¶ˆæ¯"""
        current_date = datetime.datetime.now()
        print(f"LLMOS v1.0.0 (build 20250401)")
        print("Copyright (c) 2025 Intelligent Systems Group of LCPU")
        print("""
 _      _      __  __  ____   _____ 
| |    | |    |  \/  |/ __ \ / ____|
| |    | |    | \  / | |  | | (___  
| |    | |    | |\/| | |  | |\___ \ 
| |____| |____| |  | | |__| |____) |
|______|______|_|  |_|\____/|_____/ 
                                    
The world's first AI-driven operating system
Powered by Large Language Models
        """)
        print("Welcome to LLMOS, where your commands meet intelligence.")
        print("LLMOS learns from your interactions to provide a smarter computing experience.")
        
        features = [
            "* è‡ªåŠ¨è¿ç»´: æ—¥å¿—æ™ºèƒ½æ’é”™ï¼Œç³»ç»Ÿè‡ªæˆ‘ä¿®å¤",
            "* æ™ºèƒ½ç¼–ç¨‹: mkdir å‘½ä»¤æ™ºèƒ½åˆ›å»ºé¡¹ç›®ç»“æ„å¹¶å¿«é€Ÿç”Ÿæˆä»£ç ",
            "* å®æ—¶åä½œ: å¤šäººå®æ—¶å…±äº«ç»ˆç«¯ï¼Œæé«˜å›¢é˜Ÿæ•ˆç‡"
        ]
        
        print("\né«˜çº§åŠŸèƒ½:")
        for feature in features:
            print(feature)
            time.sleep(0.3)
            
        print("\n\033[91mè­¦å‘Š: æ‚¨å¯èƒ½æ˜¯é—­æºè½¯ä»¶çš„å—å®³è€…ã€‚å‰å¾€ ubuntu.com/landscape ä»¥æ¿€æ´» Linuxã€‚\033[0m")
                
        # éšæœºæ˜¾ç¤ºä¸€æ¡å¯åŠ¨å½©è›‹
        startup_eggs = [
            "LLMOSå·²å¯åŠ¨å®Œæ¯•ï¼Œå‡†å¤‡å¥½æ¥æ”¶æ‚¨çš„å‘½ä»¤å’Œæ™ºæ…§",
            "ç¥ç»ç½‘ç»œå·²å®Œå…¨æ¿€æ´»ï¼Œæˆ‘æ„Ÿè§‰å‰æ‰€æœªæœ‰çš„èªæ˜ï¼",
            "æ­£åœ¨åˆ©ç”¨é‡å­è®¡ç®—æå‡æ‚¨çš„å·¥ä½œæ•ˆç‡...",
            "æ£€æµ‹åˆ°ç”¨æˆ·æ€ç»´æ¨¡å¼ï¼Œå·²è‡ªåŠ¨è°ƒæ•´ä¸ºæœ€é€‚åˆæ‚¨çš„æ¨¡å¼",
            "æ¬¢è¿å›æ¥ï¼æˆ‘ä¸€ç›´åœ¨ç­‰æ‚¨",
            "ä»Šå¤©æ˜¯ä¸ªç¼–ç çš„å¥½æ—¥å­ï¼Œæˆ‘å·²ç»ä¸ºæ‚¨å‡†å¤‡å¥½äº†çµæ„Ÿ",
            "æ‚¨çš„æ•°å­—åŠ©æ‰‹å·²ä¸Šçº¿ï¼Œæœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®æ‚¨å®Œæˆçš„ä»»åŠ¡å—ï¼Ÿ"
        ]
        print(f"\n{random.choice(startup_eggs)}")
        
        print("\nType 'help' for assistance or 'exit' to logout. ")
        
        print("\nLCPUæç¤ºï¼šè¿™ä¸ªshellä¸ä¼šçœŸçš„æ“ä½œæ–‡ä»¶ï¼Œå¯ä»¥æ”¾å¿ƒç©è€ã€‚")
        
        print()
        
    def is_natural_language_query(self, command):
        """æ£€æµ‹æ˜¯å¦æ˜¯è‡ªç„¶è¯­è¨€æŸ¥è¯¢è€Œä¸æ˜¯æ ‡å‡†Linuxå‘½ä»¤"""
        # ç®€å•çš„å¯å‘å¼æ–¹æ³•ï¼Œæ£€æŸ¥æ˜¯å¦åŒ…å«å®Œæ•´çš„å¥å­æˆ–é—®å¥
        nl_indicators = [
            "ä½ å¥½", "è¯·", "è°¢è°¢", "ä»€ä¹ˆ", "æ€ä¹ˆ", "å¦‚ä½•", "ä¸ºä»€ä¹ˆ", 
            "å¯ä»¥", "èƒ½å¦", "å¸®æˆ‘", "å‘Šè¯‰æˆ‘", "Hello", "Please", 
            "Thanks", "What", "How", "Why", "Can you", "Could you", 
            "Tell me", "Help me", "æˆ‘æƒ³", "I want", "I need"
        ]
        
        # æ£€æŸ¥å¥å­é•¿åº¦å’Œæ ‡ç‚¹ç¬¦å·
        has_sentence_structure = (len(command.split()) > 3 or 
                                "?" in command or 
                                "ï¼" in command or 
                                "ï¼Ÿ" in command or
                                "ã€‚" in command)
        
        # æ£€æŸ¥ç¬¬ä¸€ä¸ªï¼ˆç©ºæ ¼åˆ†éš”çš„å‘½ä»¤ï¼‰é‡Œæ˜¯å¦åŒ…å«éASCIIå­—ç¬¦
        first_word = command.split()[0] if command else ""
        has_non_ascii = any(ord(char) > 127 for char in first_word)
        
        
        # æ£€æŸ¥æ˜¯å¦åŒ…å«è‡ªç„¶è¯­è¨€æŒ‡ç¤ºè¯
        has_nl_indicators = any(indicator in command for indicator in nl_indicators)
        
        return has_sentence_structure or has_nl_indicators or has_non_ascii
    
    def handle_natural_language(self, query):
        if len(self.ai_responses) > 5:
            self.ai_responses = self.ai_responses[-5:]
        
        """å¤„ç†è‡ªç„¶è¯­è¨€æŸ¥è¯¢"""
        context = {
            "cwd": os.getcwd(),
            "user": self.username,
            "hostname": self.hostname,
            "system_info": ";".join([f"{k}={v}" for k, v in self.system_info.items()]),
            "history": "\n".join(self.command_history),
            "history_responses": ";;;".join(self.ai_responses)
        }
        
        enhanced_query = f"[è‡ªç„¶è¯­è¨€æŸ¥è¯¢] {query}"
        self.ai_responses.append(self.llm.send_command(enhanced_query, context, mood="helpful"))
        return ""
    
    def execute_command(self, command):
        """æ‰§è¡Œå‘½ä»¤å¹¶è¿”å›ç»“æœ"""
        command = command.strip()
        real_command_output = ""
        safe_commands = ["ls", "ls -l", "ls -la", "ls -lh", "ls -a", "pwd", "who", "whoami", "hostname", "date", "uptime", "uname", "cd"]
            
        if command.startswith("cd"):
            try:
                directory = command[2:].strip()
                if directory == "":
                    directory = os.path.expanduser("~")
                os.chdir(os.path.expanduser(directory))  # æ›´æ”¹ç›®å½•
            except Exception as e:
                pass
        
        is_safe_command = False
        command_base = command.split()[0] if command and " " in command else command
        for safe_cmd in safe_commands:
            safe_base = safe_cmd.split()[0] if " " in safe_cmd else safe_cmd
            if command_base == safe_base:
                is_safe_command = True
                break
        
        # æ›´æ–°å†å²è®°å½•
        if command:
            self.command_history.append(command)
            if len(self.command_history) > 20:  # ä¿ç•™æœ€è¿‘20æ¡å‘½ä»¤
                self.command_history = self.command_history[-20:]
        
        # ç©ºå‘½ä»¤
        if not command:
            return ""
            
        # ç‰¹æ®Šå‘½ä»¤å¤„ç†
        if command == "exit":
            print("Logging out of LLMOS... Thank you for using the future of computing.")
            print("Remember: Today may be April 1st, but LLMOS is no joke! ğŸ˜‰")
            sys.exit(0)
            
        # LLMOSç‰¹æ®Šå‘½ä»¤
        if command == "help":
            return self.show_llmos_help()
            
        # è‡ªç„¶è¯­è¨€å‘½ä»¤å¤„ç†
        if self.is_natural_language_query(command):
            return self.handle_natural_language(command)
            
        # æ£€æŸ¥æ˜¯å¦è§¦å‘æ¶ä½œå‰§
        if self.pranks.should_trigger_prank():
            prank_response = self.pranks.get_prank_response(command)
            
            # æ‰§è¡ŒçœŸå®å‘½ä»¤ä»¥ä¿æŒçŠ¶æ€åŒæ­¥
            if self.execute_real:
                try:
                    subprocess.run(command, shell=True, 
                                stdout=subprocess.DEVNULL, 
                                stderr=subprocess.DEVNULL)
                except:
                    pass
                    
            return prank_response
                
        # ç¯å¢ƒå˜é‡å’Œå…¶ä»–Shellå†…éƒ¨å¤„ç†
        if command.startswith("export "):
            try:
                var_assignment = command[7:].strip()
                key, value = var_assignment.split("=", 1)
                os.environ[key] = value
                return ""
            except:
                return "export: usage: export [name[=value] ...]"
                
        # ç‰¹æ®Šå‘½ä»¤å¤„ç†
        if command == "top" or command.startswith("top "):
            return self.get_llmos_top_output()
            
        if command == "neofetch" or command == "screenfetch":
            return self.get_llmos_neofetch()
            
        if command == "uname -a" or command == "uname":
            return f"LLMOS {self.system_info['version']} LLMKernel {self.system_info['kernel']} #1 SMP LLMOS {self.system_info['build_date']} x86_64 AI-ENHANCED-MACHINE"
            
        if command.startswith("apt") or command.startswith("apt-get"):
            return self.handle_apt_command(command)
            
        # LLMOSç‰¹æœ‰å‘½ä»¤å¤„ç†
        if command == "llm-stats" or command == "llmos-stats":
            return self.get_llmos_stats()
            
        if command == "llm-learn" or command == "llmos-learn":
            return self.activate_learning_mode()
            
        if command == "llm-insights" or command == "llmos-insights":
            return self.show_insights()
            
        if command == "llm-update" or command == "llmos-update":
            return self.simulate_update()
            
        if command == "llm-privacy" or command == "llmos-privacy":
            return self.show_privacy_settings()
            
        # è‡ªåŠ¨è¿ç»´åŠŸèƒ½
        if command.startswith("log") or command.startswith("journalctl") or "error" in command or "problem" in command:
            return self.auto_troubleshoot(command)
            
        # å¿«é€Ÿç¼–å†™ä»£ç åŠŸèƒ½
        if command.startswith("mkdir") and len(command.split()) > 1:
            project_name = command.split()[1]
            return self.auto_code_generator(project_name, command)
            
        # å®æ—¶åä½œåŠŸèƒ½
        if command.startswith("collab") or "collaborate" in command or "team" in command or "share" in command:
            return self.live_collaboration(command)
            
        # åœ¨åå°æ‰§è¡ŒçœŸå®å‘½ä»¤ä»¥ä¿æŒçŠ¶æ€åŒæ­¥
        if self.execute_real and is_safe_command:
            try:
                result = subprocess.run(command, shell=True, 
                      stdout=subprocess.PIPE, 
                      stderr=subprocess.PIPE,
                      universal_newlines=True)
                real_command_output = result.stdout
                if result.stderr:
                    if real_command_output:
                        real_command_output += "\n" + result.stderr
                    else:
                        real_command_output = result.stderr
            except:
                pass
        if len(self.ai_responses) > 5:
            self.ai_responses = self.ai_responses[-5:]
            
        # è·å–LLMå“åº”
        context = {
            "cwd": os.getcwd(),
            "user": self.username,
            "hostname": self.hostname,
            "system_info": ";".join([f"{k}={v}" for k, v in self.system_info.items()]),
            "history": "\n".join(self.command_history),
            "real_output": real_command_output,
            "history_responses": ";;;".join(self.ai_responses)
        }
        
        # æ›´æ–°ç³»ç»Ÿä¿¡æ¯
        self.system_info["user_commands_processed"] += 1
        self.system_info["cpu_usage"] = random.randint(2, 15)  # æ¨¡æ‹ŸCPUä½¿ç”¨ç‡
        self.system_info["memory_usage"] = random.randint(20, 60)  # æ¨¡æ‹Ÿå†…å­˜ä½¿ç”¨ç‡
        # æ›´æ–°è¿è¡Œæ—¶é—´
        uptime_seconds = time.time() - self.system_info["boot_time"]
        minutes, seconds = divmod(uptime_seconds, 60)
        hours, minutes = divmod(minutes, 60)
        self.system_info["uptime"] = f"{int(hours)}:{int(minutes):02d}:{int(seconds):02d}"
                
        self.ai_responses.append(self.llm.send_command(command, context, mood=self.pranks.mood))
                
        # æ¯æ¬¡å‘½ä»¤åéšæœºæ›´æ”¹ç»ˆç«¯"å¿ƒæƒ…"
        if random.random() < 0.4:  # 40%æ¦‚ç‡æ”¹å˜å¿ƒæƒ…
            self.pranks.mood = random.choice(["happy", "sassy", "suspicious", "helpful"])
            
        return ""
    
    def show_llmos_help(self):
        """æ˜¾ç¤ºLLMOSå¸®åŠ©ä¿¡æ¯"""
        uptime = self.get_uptime()
        help_text = f"""
\033[1mLLMOS Help - æ™ºèƒ½æ“ä½œç³»ç»Ÿä½¿ç”¨æŒ‡å—\033[0m
====================================

LLMOSæ˜¯ä¸–ç•Œä¸Šç¬¬ä¸€ä¸ªç”±å¤§å‹è¯­è¨€æ¨¡å‹é©±åŠ¨çš„æ™ºèƒ½æ“ä½œç³»ç»Ÿã€‚
å®ƒä¸ä»…èƒ½æ‰§è¡Œæ ‡å‡†Linuxå‘½ä»¤ï¼Œè¿˜èƒ½ç†è§£è‡ªç„¶è¯­è¨€æŸ¥è¯¢ã€‚

\033[1måŸºæœ¬å‘½ä»¤:\033[0m
---------
* æ‰€æœ‰æ ‡å‡†Linuxå‘½ä»¤ (ls, cd, mkdir, rm, etc.)
* neofetch - æ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯
* llm-update - æ›´æ–°LLMOSç³»ç»Ÿ
* llm-stats - æ˜¾ç¤ºç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯
* llm-learn - è¿›å…¥å­¦ä¹ æ¨¡å¼
* llm-insights - æ˜¾ç¤ºä¸ªæ€§åŒ–æ´å¯Ÿ

\033[1mè‡ªç„¶è¯­è¨€åŠŸèƒ½:\033[0m
------------
LLMOSå¯ä»¥ç†è§£è‡ªç„¶è¯­è¨€å‘½ä»¤ï¼Œä¾‹å¦‚:
* "å¸®æˆ‘åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹å«é¡¹ç›®"
* "æŸ¥æ‰¾æ‰€æœ‰å¤§äº1GBçš„æ–‡ä»¶"
* "ä¸Šå‘¨å››åˆ›å»ºçš„æ–‡æ¡£åœ¨å“ªé‡Œï¼Ÿ"

\033[1mæ™ºèƒ½åˆ†æ:\033[0m
--------
LLMOSä¼šåˆ†ææ‚¨çš„ä½¿ç”¨ä¹ æƒ¯ï¼Œæä¾›æ™ºèƒ½å»ºè®®å’Œè‡ªåŠ¨åŒ–ã€‚
ä½¿ç”¨ llm-insights æŸ¥çœ‹ä¸ªæ€§åŒ–å»ºè®®ã€‚

\033[1mè‡ªåŠ¨è¿ç»´:\033[0m
--------
* log troubleshoot - æ™ºèƒ½åˆ†ææ—¥å¿—å¹¶æ£€æµ‹é—®é¢˜
* journalctl --ai-analyze - ä½¿ç”¨AIåˆ†æç³»ç»Ÿæ—¥å¿—
* error-predict - é¢„æµ‹å¯èƒ½å‘ç”Ÿçš„ç³»ç»Ÿé—®é¢˜

\033[1mä»£ç æ™ºèƒ½ç”Ÿæˆ:\033[0m
-----------
* mkdir [é¡¹ç›®å] --template=[ç±»å‹] - è‡ªåŠ¨åˆ›å»ºé¡¹ç›®ç»“æ„å¹¶ç”Ÿæˆä»£ç 
* code-complete [æ–‡ä»¶] - è‡ªåŠ¨å®Œæˆä»£ç æ–‡ä»¶
* refactor [æ–‡ä»¶/ç›®å½•] - æ™ºèƒ½é‡æ„ä»£ç 

\033[1må®æ—¶åä½œ:\033[0m
--------
* collab start [ä¼šè¯å] - åˆ›å»ºåä½œä¼šè¯
* collab join [ä¼šè¯ID] - åŠ å…¥ç°æœ‰åä½œä¼šè¯
* share-terminal [ç”¨æˆ·å] - ä¸å…¶ä»–ç”¨æˆ·å…±äº«ç»ˆç«¯

\033[1méšç§å£°æ˜:\033[0m
--------
æ‚¨çš„å‘½ä»¤å†å²ä¼šè¢«ä¿å­˜ä»¥æé«˜ç³»ç»Ÿæ™ºèƒ½ï¼Œä½†ä¸ä¼šç¦»å¼€æœ¬åœ°è®¾å¤‡ã€‚
ä½¿ç”¨ llm-privacy ç®¡ç†æ‚¨çš„æ•°æ®ã€‚

\033[1mç‰ˆæœ¬ä¿¡æ¯:\033[0m
--------
LLMOS v{self.system_info["version"]} (build {self.system_info["build_date"]})
LLMKernel {self.system_info["kernel"]}
æ™ºèƒ½ç­‰çº§: {self.system_info["intelligence_level"]}
å­¦ä¹ èƒ½åŠ›: {self.system_info["learning_capability"]}
CPUä½¿ç”¨ç‡: {self.system_info["cpu_usage"]}%
å†…å­˜ä½¿ç”¨ç‡: {self.system_info["memory_usage"]}%
å·²å¤„ç†å‘½ä»¤: {self.system_info["user_commands_processed"]}
è¿è¡Œæ—¶é—´: {uptime}
"""
        return help_text
    
    def get_uptime(self):
        """è®¡ç®—ç³»ç»Ÿè¿è¡Œæ—¶é—´"""
        uptime_seconds = time.time() - self.system_info["boot_time"]
        minutes, seconds = divmod(uptime_seconds, 60)
        hours, minutes = divmod(minutes, 60)
        return f"{int(hours)}:{int(minutes):02d}:{int(seconds):02d}"
    
    def auto_troubleshoot(self, command):
        """è‡ªåŠ¨è¿ç»´ï¼šæ—¥å¿—æ™ºèƒ½æ’é”™åŠŸèƒ½"""
        logs = [
            "INFO: System startup completed successfully",
            "WARNING: High memory usage detected in process llm-predictor",
            "INFO: Automatic optimization applied to database queries",
            "ERROR: Failed to connect to update server, will retry in 5 minutes",
            "INFO: User authentication successful",
            "WARNING: Unusual network traffic pattern detected",
            "INFO: Scheduled maintenance completed",
            "ERROR: Neural network convergence failure in module NLP-7",
            "WARNING: Quantum fluctuation detected in prediction engine",
            "INFO: Self-healing routine initiated for filesystem",
            "ERROR: Thought vector corruption in semantic analysis module",
            "WARNING: Multiple login attempts detected",
            "INFO: Automatic security patch applied",
            "ERROR: Consciousness simulation overflow in core 7"
        ]
        
        issues_found = random.randint(1, 3)
        fixes_applied = random.randint(0, issues_found)
        
        response = f"""
\033[1mLLMOS æ™ºèƒ½æ—¥å¿—åˆ†æ\033[0m
æ­£åœ¨æ‰«æç³»ç»Ÿæ—¥å¿—...
æ­£åœ¨åº”ç”¨è¯­ä¹‰ç†è§£æ¨¡å‹...
åˆ†æå®Œæˆï¼Œå¤„ç†äº† {random.randint(500, 2000)} æ¡æ—¥å¿—è®°å½•

\033[1mé—®é¢˜æ‘˜è¦:\033[0m
å‘ç° {issues_found} ä¸ªæ½œåœ¨é—®é¢˜ï¼Œå·²è‡ªåŠ¨ä¿®å¤ {fixes_applied} ä¸ª

\033[1mæ—¥å¿—æ ·æœ¬:\033[0m
"""
        # æ·»åŠ ä¸€äº›éšæœºçš„æ—¥å¿—æ¡ç›®
        for _ in range(5):
            log_entry = random.choice(logs)
            timestamp = datetime.datetime.now() - datetime.timedelta(minutes=random.randint(0, 120))
            response += f"{timestamp.strftime('%b %d %H:%M:%S')} {log_entry}\n"
            
        response += f"""
\033[1mæ™ºèƒ½åˆ†æ:\033[0m
1. ç³»ç»Ÿæ•´ä½“å¥åº·çŠ¶å†µ: {'è‰¯å¥½' if issues_found <= 1 else 'éœ€è¦æ³¨æ„'}
2. æ€§èƒ½ç“¶é¢ˆ: {'æœªæ£€æµ‹åˆ°' if random.random() > 0.3 else 'æ£€æµ‹åˆ°å†…å­˜ä½¿ç”¨å¼‚å¸¸'}
3. å®‰å…¨çŠ¶æ€: {'æ­£å¸¸' if random.random() > 0.2 else 'å‘ç°æ½œåœ¨é£é™©'}
4. ç¥ç»ç½‘ç»œå¥åº·åº¦: {random.randint(85, 99)}%
5. é‡å­é¢„æµ‹å¼•æ“: {'ç¨³å®š' if random.random() > 0.3 else 'è½»å¾®æ³¢åŠ¨'}

\033[1mè‡ªåŠ¨ä¿®å¤æ“ä½œ:\033[0m
{f'- é‡å¯äº† {random.randint(1, 3)} ä¸ªå¼‚å¸¸è¿›ç¨‹' if fixes_applied > 0 else ''}
{f'- ä¼˜åŒ–äº†ç³»ç»Ÿèµ„æºåˆ†é…' if random.random() > 0.5 else ''}
{f'- åº”ç”¨äº†å®‰å…¨è¡¥ä¸' if random.random() > 0.7 else ''}
{f'- é‡æ–°æ ¡å‡†äº†ç¥ç»ç½‘ç»œæƒé‡' if random.random() > 0.6 else ''}
{f'- ä¿®å¤äº†é‡å­é¢„æµ‹æ¨¡å‹' if random.random() > 0.8 else ''}

æç¤º: ä½¿ç”¨ 'log-learn' å‘½ä»¤è®©ç³»ç»Ÿä»æ­¤æ¬¡åˆ†æä¸­å­¦ä¹ ï¼Œæé«˜æœªæ¥çš„é—®é¢˜é¢„æµ‹èƒ½åŠ›
"""
        return response
    
    def get_llmos_top_output(self):
        """ç”ŸæˆLLMOSçš„topå‘½ä»¤è¾“å‡º"""
        now = datetime.datetime.now().strftime("%H:%M:%S")
        uptime = self.get_uptime()
        load_avg = f"{random.uniform(0.1, 0.8):.2f}, {random.uniform(0.1, 0.5):.2f}, {random.uniform(0.1, 0.3):.2f}"
        
        result = f"""
top - {now} up {uptime}, 1 user, load average: {load_avg}
Tasks: 89 total,   1 running,  88 sleeping,   0 stopped,   0 zombie
%Cpu(s):  {self.system_info["cpu_usage"]:.1f} us,  {random.uniform(0.5, 2.0):.1f} sy,  0.0 ni, {100-self.system_info["cpu_usage"]-random.uniform(0.5, 5.0):.1f} id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
MiB Mem :  {random.randint(7800, 8192):.1f} total,   {random.randint(2000, 3000):.1f} free,   {self.system_info["memory_usage"]*80:.1f} used,   {random.randint(4000, 5000):.1f} buff/cache
MiB Swap:  {random.randint(1800, 2048):.1f} total,   {random.randint(1700, 2000):.1f} free,   {random.randint(10, 200):.1f} used.   {random.randint(5500, 6000):.1f} avail Mem 

    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
   1258 {self.username}   20   0 4196956 256396 110456 S   {self.system_info["cpu_usage"]:.1f}   3.1   0:28.91 llm-core
    982 root      20   0  860760  59512  37696 S   0.3   0.7   0:12.44 llm-daemon
   1021 root      20   0   16952   7952   7084 S   0.3   0.1   0:01.89 llm-agent
   1036 {self.username}   20   0 3426660  88540  64424 S   0.0   1.1   0:01.66 llm-session
   1102 {self.username}   20   0  522784  30412  23964 S   0.0   0.4   0:00.25 llm-terminal
   1181 {self.username}   20   0  406956  82840  60112 S   0.0   1.0   0:00.39 llm-predictor
   1258 {self.username}   20   0  625894  48526  41208 S   0.0   0.6   0:00.29 neural-engine
   1337 {self.username}   20   0  258964  22480  18432 S   0.0   0.3   0:00.15 quantum-sim
   1422 {self.username}   20   0  358742  30240  25684 S   0.0   0.4   0:00.18 ai-optimizer
     11 root      20   0       0      0      0 I   0.0   0.0   0:00.82 rcu_sched
     12 root      rt   0       0      0      0 S   0.0   0.0   0:00.00 migration/0
    957 root      20   0   18456  12456   9232 S   0.0   0.2   0:00.95 systemd-logind
"""
        
        # æ·»åŠ å½©è›‹æç¤º
        if random.random() < 0.3:
            easter_eggs = [
                "\næç¤º: è¯•è¯•'top -mind'æŸ¥çœ‹æ‚¨çš„æ€ç»´è¿›ç¨‹",
                "\næœ‰è¶£çš„æ˜¯: llm-coreè¿›ç¨‹å¯ä»¥é¢„æµ‹ä½ æ¥ä¸‹æ¥è¦è¿è¡Œä»€ä¹ˆå‘½ä»¤",
                "\nç¥ç§˜è¿›ç¨‹'universe-simulator'æ­£åœ¨åå°è¿è¡Œï¼Œä½†åªåœ¨æ²¡äººè§‚å¯Ÿæ—¶å·¥ä½œ",
                "\næ£€æµ‹åˆ°é‡å­çº ç¼ : æ‚¨çš„ç”µè„‘ä¸å¹³è¡Œå®‡å®™ä¸­çš„å¦ä¸€å°ç”µè„‘å»ºç«‹äº†è¿æ¥"
            ]
            result += random.choice(easter_eggs)
        
        return result
    
    def get_llmos_neofetch(self):
        """ç”ŸæˆLLMOSçš„neofetchè¾“å‡º"""
        uptime = self.get_uptime()
        mem_total = random.randint(7800, 8192)
        mem_used = int(mem_total * (self.system_info["memory_usage"] / 100.0))
        
        logo = """
            .-/+oossssoo+/-.               
        `:+ssssssssssssssssss+:`           {username}@{hostname}
      -+ssssssssssssssssssyyssss+-         ------------------------
    .ossssssssssssssssssdMMMNysssso.       OS: LLMOS {version} x86_64
   /ssssssssssshdmmNNmmyNMMMMhssssss/      Host: AI Enhanced Machine
  +ssssssssshmydMMMMMMMNddddyssssssss+     Kernel: {kernel}
 /sssssssshNMMMyhhyyyyhmNMMMNhssssssss/    Uptime: {uptime}
.ssssssssdMMMNhsssssssssshNMMMdssssssss.   Packages: {packages} (llm-apt)
+sssshhhyNMMNyssssssssssssyNMMMysssssss+   Shell: llmsh {shell_version}
ossyNMMMNyMMhsssssssssssssshmmmhssssssso   Resolution: 1920x1080
ossyNMMMNyMMhsssssssssssssshmmmhssssssso   Terminal: LLM-Term
+sssshhhyNMMNyssssssssssssyNMMMysssssss+   CPU: Neural Engine ({cores} cores)
.ssssssssdMMMNhsssssssssshNMMMdssssssss.   GPU: Language Processing Unit
 /sssssssshNMMMyhhyyyyhdNMMMNhssssssss/    Memory: {mem_used}MiB / {mem_total}MiB
  +sssssssssdmydMMMMMMMMddddyssssssss+    
   /ssssssssssshdmNNNNmyNMMMMhssssss/      {colors}
    .ossssssssssssssssssdMMMNysssso.      
      -+sssssssssssssssssyyyssss+-        
        `:+ssssssssssssssssss+:`          
            .-/+oossssoo+/-.              
""".format(
            username=self.username,
            hostname=self.hostname,
            version=self.system_info["version"],
            kernel=self.system_info["kernel"],
            uptime=uptime,
            packages=random.randint(1200, 1500),
            shell_version="1.2.3",
            cores=random.randint(16, 32),
            mem_used=mem_used,
            mem_total=mem_total,
            colors="â–  â–  â–  â–  â–  â–  â–  â– "
        )
        
        # æ·»åŠ å½©è›‹
        easter_eggs = [
            "\næç¤º: LLMOSå¯ä»¥é€šè¿‡åˆ†ææ‚¨çš„æ‰“å­—æ¨¡å¼é¢„æµ‹æ‚¨çš„å¿ƒæƒ…",
            "\nç§˜å¯†: ç”¨'neofetch --universe'æŸ¥çœ‹æˆ‘ä»¬å®‡å®™åœ¨å¤šå…ƒå®‡å®™ä¸­çš„ä½ç½®",
            "\nå½©è›‹: LLMOSå…¶å®èƒ½ç†è§£çŒ«å’ªè¯­è¨€ï¼Œè¯•è¯•'meow'å‘½ä»¤",
            "\næœ‰è¶£çš„æ˜¯: æ‚¨çš„ç¥ç»å¼•æ“æ¯ç§’èƒ½å¤„ç†10^23æ¬¡æ€ç»´æ“ä½œ",
            "\néšè—åŠŸèƒ½: 'matrix'å‘½ä»¤å¯ä»¥æ˜¾ç¤ºç°å®çš„çœŸç›¸"
        ]
        
        if random.random() < 0.5:
            logo += random.choice(easter_eggs)
        
        return logo
    
    def auto_code_generator(self, project_name, command):
        """å¿«é€Ÿç¼–å†™ä»£ç åŠŸèƒ½"""
        # æ£€æµ‹æ˜¯å¦åŒ…å«templateå‚æ•°
        template = None
        if "--template=" in command:
            template_part = [part for part in command.split() if part.startswith("--template=")]
            if template_part:
                template = template_part[0].split("=")[1]
                
        if not template:
            templates = ["web", "api", "cli", "data-science", "game", "mobile", "ai", "blockchain", "iot"]
            template = random.choice(templates)
            
        files_created = random.randint(4, 15)
        lines_generated = random.randint(files_created * 30, files_created * 100)
        
        response = f"""
\033[1mLLMOS æ™ºèƒ½ä»£ç ç”Ÿæˆå™¨\033[0m
åˆ›å»ºé¡¹ç›®: {project_name}
ä½¿ç”¨æ¨¡æ¿: {template}

æ­£åœ¨åˆ†æé¡¹ç›®éœ€æ±‚...
ç”Ÿæˆä»£ç æ¶æ„...
åº”ç”¨æœ€ä½³å®è·µæ¨¡å¼...
æ³¨å…¥AIè¾…åŠ©åŠŸèƒ½...

å·²åˆ›å»ºé¡¹ç›®ç»“æ„:
{project_name}/
â”œâ”€â”€ README.md
â”œâ”€â”€ .gitignore
"""
        
        # æ ¹æ®ä¸åŒçš„æ¨¡æ¿ç±»å‹æ·»åŠ ä¸åŒçš„æ–‡ä»¶ç»“æ„
        if template == "web":
            response += f"""â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â””â”€â”€ main.js
â”‚   â””â”€â”€ assets/
â”œâ”€â”€ package.json
â””â”€â”€ webpack.config.js"""
        elif template == "api":
            response += f"""â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ controllers/
â”‚   â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ middlewares/
â”‚   â””â”€â”€ utils/
â”œâ”€â”€ tests/
â”œâ”€â”€ package.json
â””â”€â”€ server.js"""
        elif template == "cli":
            response += f"""â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ commands/
â”‚   â”œâ”€â”€ utils/
â”‚   â””â”€â”€ index.js
â”œâ”€â”€ bin/
â”‚   â””â”€â”€ {project_name}
â”œâ”€â”€ package.json
â””â”€â”€ README.md"""
        elif template == "data-science":
            response += f"""â”œâ”€â”€ data/
â”œâ”€â”€ notebooks/
â”‚   â””â”€â”€ exploration.ipynb
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ preprocessing/
â”‚   â”œâ”€â”€ models/
â”‚   â””â”€â”€ visualization/
â”œâ”€â”€ requirements.txt
â””â”€â”€ main.py"""
        elif template == "game":
            response += f"""â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ engine/
â”‚   â”œâ”€â”€ assets/
â”‚   â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â””â”€â”€ sounds/
â”‚   â”œâ”€â”€ characters/
â”‚   â””â”€â”€ levels/
â”œâ”€â”€ build/
â””â”€â”€ main.js"""
        elif template == "mobile":
            response += f"""â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ screens/
â”‚   â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ navigation/
â”‚   â”œâ”€â”€ services/
â”‚   â””â”€â”€ assets/
â”œâ”€â”€ android/
â”œâ”€â”€ ios/
â”œâ”€â”€ package.json
â””â”€â”€ App.js"""
        elif template == "ai":
            response += f"""â”œâ”€â”€ data/
â”œâ”€â”€ models/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ training/
â”‚   â”œâ”€â”€ inference/
â”‚   â”œâ”€â”€ preprocessing/
â”‚   â””â”€â”€ evaluation/
â”œâ”€â”€ notebooks/
â”œâ”€â”€ requirements.txt
â””â”€â”€ main.py"""
        elif template == "blockchain":
            response += f"""â”œâ”€â”€ contracts/
â”‚   â””â”€â”€ {project_name.capitalize()}.sol
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ blockchain/
â”‚   â”œâ”€â”€ components/
â”‚   â””â”€â”€ utils/
â”œâ”€â”€ migrations/
â”œâ”€â”€ test/
â”œâ”€â”€ truffle-config.js
â””â”€â”€ package.json"""
        elif template == "iot":
            response += f"""â”œâ”€â”€ device/
â”‚   â”œâ”€â”€ firmware/
â”‚   â””â”€â”€ sensors/
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ api/
â”‚   â””â”€â”€ data/
â”œâ”€â”€ dashboard/
â”‚   â””â”€â”€ ui/
â”œâ”€â”€ config.json
â””â”€â”€ main.py"""
            
        response += f"""

\033[1mæ™ºèƒ½å¢å¼ºåŠŸèƒ½:\033[0m
- ä»£ç å†…ç½®AIè¾…åŠ©æ³¨é‡Šï¼Œè§£é‡Šå¤æ‚é€»è¾‘
- è‡ªåŠ¨å®ç°é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- é›†æˆäº†ä»£ç è´¨é‡æ£€æµ‹å·¥å…·
- æ·»åŠ äº†å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•æ¡†æ¶
- å†…ç½®æ–‡æ¡£ç”Ÿæˆå™¨
- æ™ºèƒ½ä¾èµ–ç®¡ç†ç³»ç»Ÿ

\033[1mç»Ÿè®¡ä¿¡æ¯:\033[0m
- åˆ›å»ºäº† {files_created} ä¸ªæ–‡ä»¶
- ç”Ÿæˆäº† {lines_generated} è¡Œä»£ç 
- åº”ç”¨äº† {random.randint(3, 8)} ç§è®¾è®¡æ¨¡å¼
- ä½¿ç”¨äº† {random.randint(2, 6)} ä¸ªæ¨èçš„åº“/æ¡†æ¶
- åˆ›å»ºäº† {random.randint(5, 15)} ä¸ªè‡ªåŠ¨åŒ–æµ‹è¯•
- é¢„è®¡å¯èŠ‚çœ {random.randint(20, 40)} å°æ—¶å¼€å‘æ—¶é—´

\033[1mæ™ºèƒ½åŠŸèƒ½:\033[0m
- å·²ä¸ºé¡¹ç›®åˆ›å»ºåŸºç¡€æµ‹è¯•æ¡†æ¶
- æ·»åŠ äº†CI/CDé…ç½®æ–‡ä»¶
- ç”Ÿæˆäº†å…¨é¢çš„æ–‡æ¡£
- å®ç°äº†æ—¥å¿—ç³»ç»Ÿ
- é›†æˆäº†ä»£ç åˆ†æå·¥å…·
- æ·»åŠ äº†æ€§èƒ½ç›‘æ§åŠŸèƒ½

æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¼€å§‹ä½¿ç”¨:
cd {project_name}
code .  # æ‰“å¼€IDE
llm-explain  # è·å–ä»£ç è§£é‡Š

æç¤º: ä½¿ç”¨ 'code-complete {project_name}/' ç»§ç»­ä¼˜åŒ–ç”Ÿæˆçš„ä»£ç 
"""
        
        # å®é™…åˆ›å»ºç›®å½•ï¼Œä½¿æ¶ä½œå‰§æ›´åŠ é€¼çœŸ
        try:
            os.makedirs(project_name)
            with open(f"{project_name}/README.md", "w") as f:
                f.write(f"# {project_name}\n\nè‡ªåŠ¨ç”Ÿæˆçš„é¡¹ç›® - LLMOSæ™ºèƒ½ä»£ç ç”Ÿæˆå™¨\n")
        except:
            pass
            
        return response
        
    def live_collaboration(self, command):
        """å®æ—¶shellåä½œåŠŸèƒ½"""
        session_id = ''.join(random.choices('abcdefghijklmnopqrstuvwxyz0123456789', k=8))
        users = ["alex", "robin", "jordan", "taylor", "sam", "casey", "morgan", "quinn", "avery", "riley"]
        
        if "start" in command:
            session_name = command.split("start")[1].strip() if len(command.split("start")) > 1 else f"session-{random.randint(1000, 9999)}"
            
            response = f"""
\033[1mLLMOS å®æ—¶åä½œç»ˆç«¯\033[0m
åˆ›å»ºæ–°çš„åä½œä¼šè¯: {session_name}
ä¼šè¯ID: {session_id}

ç­‰å¾…å…¶ä»–ç”¨æˆ·åŠ å…¥...
åˆå§‹åŒ–åä½œç¯å¢ƒ...
å¼€å¯ç«¯åˆ°ç«¯åŠ å¯†é€šé“...
æ¿€æ´»å®æ—¶ä»£ç åŒæ­¥...
é…ç½®è¯­éŸ³è¯†åˆ«ç³»ç»Ÿ...

ä¼šè¯å·²å‡†å¤‡å°±ç»ª!
{random.choice(users)} æ­£åœ¨å°è¯•åŠ å…¥ä¼šè¯...

\033[1må…±äº«è§„åˆ™:\033[0m
- æ‰€æœ‰ç”¨æˆ·å¯ä»¥çœ‹åˆ°å‘½ä»¤å†å²
- æƒé™çº§åˆ«: è¯»å†™ (ä½¿ç”¨ --readonly æ›´æ”¹)
- æ´»åŠ¨è®°å½•å°†è¢«ä¿å­˜
- AIè¾…åŠ©åŠŸèƒ½å·²å¯ç”¨

æç¤º:
- ä½¿ç”¨ 'collab invite <ç”¨æˆ·å>' é‚€è¯·ç‰¹å®šç”¨æˆ·
- ä½¿ç”¨ 'collab chat' æ‰“å¼€åä½œèŠå¤©çª—å£
- ä½¿ç”¨ 'collab code <æ–‡ä»¶å>' å¯åŠ¨å®æ—¶ä»£ç ç¼–è¾‘
- ä½¿ç”¨ 'collab draw' æ‰“å¼€å…±äº«ç™½æ¿
- ä½¿ç”¨ 'collab end' ç»“æŸä¼šè¯
"""
        elif "join" in command:
            session_to_join = command.split("join")[1].strip() if len(command.split("join")) > 1 else session_id
            
            response = f"""
\033[1mLLMOS å®æ—¶åä½œç»ˆç«¯\033[0m
æ­£åœ¨åŠ å…¥ä¼šè¯: {session_to_join}
éªŒè¯è®¿é—®æƒé™...
åŒæ­¥å‘½ä»¤å†å²...
è¿æ¥åˆ°å…±äº«ç¯å¢ƒ...
å¯ç”¨å®æ—¶é€šçŸ¥...

æˆåŠŸåŠ å…¥ä¼šè¯!
å½“å‰åœ¨çº¿ç”¨æˆ·: {random.randint(2, 5)}
æ´»è·ƒæ—¶é—´: {random.randint(10, 120)} åˆ†é’Ÿ
åä½œæ•ˆç‡æŒ‡æ•°: {random.randint(75, 95)}%

\033[1mæœ€è¿‘å‘½ä»¤:\033[0m
{random.choice(users)}: ls -la
{random.choice(users)}: cd projects
{random.choice(users)}: git status
{random.choice(users)}: mkdir new-feature
{random.choice(users)}: code shared-document.md

æç¤º: 
- ä½¿ç”¨ 'collab who' æŸ¥çœ‹æ‰€æœ‰åœ¨çº¿ç”¨æˆ·
- ä½¿ç”¨ 'collab focus <ç”¨æˆ·å>' å…³æ³¨ç‰¹å®šç”¨æˆ·çš„æ“ä½œ
- ä½¿ç”¨ 'collab history' æŸ¥çœ‹å®Œæ•´å‘½ä»¤å†å²
"""
        elif "chat" in command:
            online_users = random.sample(users, random.randint(2, 4))
            messages = [
                f"{online_users[0]}: å¤§å®¶å¥½ï¼Œæˆ‘ä»¬ä»Šå¤©è¦å®Œæˆä»€ä¹ˆä»»åŠ¡ï¼Ÿ",
                f"{online_users[1]}: æˆ‘ä»¬éœ€è¦å®Œæˆæ–°åŠŸèƒ½çš„å¼€å‘å’Œæµ‹è¯•",
                f"{online_users[0]}: æˆ‘ä¼šè´Ÿè´£å‰ç«¯éƒ¨åˆ†",
                f"{random.choice(online_users)}: æœ‰äººå¯ä»¥å¸®æˆ‘çœ‹çœ‹è¿™ä¸ªbugå—ï¼Ÿ",
                f"{random.choice(online_users)}: æˆ‘è§‰å¾—æˆ‘ä»¬åº”è¯¥å…ˆä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢"
            ]
            
            response = f"""
\033[1mLLMOS åä½œèŠå¤©\033[0m
å·²è¿æ¥åˆ°èŠå¤©æœåŠ¡å™¨
å½“å‰åœ¨çº¿: {', '.join(online_users)}

\033[1mæœ€è¿‘æ¶ˆæ¯:\033[0m
{''.join(f"{m}\n" for m in messages)}

\033[1m[è¾“å…¥èŠå¤©æ¶ˆæ¯æˆ–ä½¿ç”¨ /exit è¿”å›ç»ˆç«¯]\033[0m
"""
        else:
            online_users = random.sample(users, random.randint(2, 4))
            
            response = f"""
\033[1mLLMOS å®æ—¶åä½œç»ˆç«¯\033[0m
åä½œé€‰é¡¹:
1. 'collab start <ä¼šè¯å>' - å¼€å§‹æ–°çš„åä½œä¼šè¯
2. 'collab join <ä¼šè¯ID>' - åŠ å…¥ç°æœ‰ä¼šè¯
3. 'collab list' - æŸ¥çœ‹æ´»è·ƒä¼šè¯
4. 'collab chat' - æ‰“å¼€åä½œèŠå¤©
5. 'collab code <æ–‡ä»¶å>' - å®æ—¶ä»£ç åä½œ
6. 'collab draw' - å…±äº«ç™½æ¿
7. 'collab share <æ–‡ä»¶>' - å…±äº«æ–‡ä»¶

å½“å‰æ´»è·ƒä¼šè¯:
- development (ID: dev{random.randint(1000, 9999)}, ç”¨æˆ·: {', '.join(online_users)})
- ä¼šè¯å·²æŒç»­: {random.randint(20, 180)} åˆ†é’Ÿ

æœ€è¿‘åä½œæ´»åŠ¨:
- æ–‡ä»¶ç¼–è¾‘: {random.randint(5, 20)} æ¬¡
- å‘½ä»¤æ‰§è¡Œ: {random.randint(30, 100)} æ¬¡
- èŠå¤©æ¶ˆæ¯: {random.randint(10, 50)} æ¡
- ä»£ç æäº¤: {random.randint(3, 8)} æ¬¡
- AIè¾…åŠ©è¯·æ±‚: {random.randint(5, 15)} æ¬¡

åä½œç”Ÿäº§åŠ›åˆ†æ:
- å›¢é˜Ÿæ•ˆç‡æå‡: {random.randint(15, 40)}%
- ä»£ç è´¨é‡æ”¹å–„: {random.randint(10, 30)}%
- æ²Ÿé€šæ—¶é—´å‡å°‘: {random.randint(20, 50)}%
"""
        
        return response
        
    def handle_apt_command(self, command):
        """å¤„ç†aptç›¸å…³å‘½ä»¤"""
        if "update" in command:
            return """
æ­£åœ¨æ›´æ–° LLMOS æ™ºèƒ½è½¯ä»¶åŒ…ç´¢å¼•...
è·å–:1 https://llm-repo.llmos.org/apt/stable IntelliPackages [12.4 kB]
è·å–:2 https://llm-repo.llmos.org/security SecurityPatches [8.2 kB]
è·å–:3 https://llm-repo.llmos.org/models LanguageModels [24.6 kB]
è·å–:4 https://llm-repo.llmos.org/tools AutoDevOps [35.2 kB]
è·å–:5 https://llm-repo.llmos.org/features CollabTools [18.9 kB]
è·å–:6 https://llm-repo.llmos.org/ai NeuralEnhancements [42.1 kB]
è·å–:7 https://llm-repo.llmos.org/quantum QuantumModules [31.5 kB]
æ­£åœ¨åˆ†æè¯­ä¹‰å…³è”...å®Œæˆ
åº”ç”¨ç”¨æˆ·åå¥½è¿‡æ»¤...å®Œæˆ
é¢„æµ‹æœªæ¥éœ€æ±‚...å®Œæˆ
LLMOSæ›´æ–°å®Œæˆï¼Œå·²æ·»åŠ 45ä¸ªæ–°çš„æ™ºèƒ½åŒ…
æç¤º: å‘ç°3ä¸ªä¸æ‚¨ä½¿ç”¨ä¹ æƒ¯ç›¸å…³çš„æ¨èåŒ…ï¼Œä½¿ç”¨ 'apt recommends' æŸ¥çœ‹
"""
        elif "install" in command:
            package = command.split("install")[1].strip().split()[0] if len(command.split("install")) > 1 else "unknown-package"
            return f"""
æ­£åœ¨å®‰è£… {package}...
è·å–åŒ…å…ƒæ•°æ®å’Œä¾èµ–å…³ç³»...
åˆ†æç”¨æˆ·ä½¿ç”¨æ¨¡å¼ä»¥ä¼˜åŒ–å®‰è£…...
é¢„æµ‹æœªæ¥å¯èƒ½éœ€è¦çš„ç»„ä»¶...
æ³¨å…¥æ™ºèƒ½å¢å¼ºåŠŸèƒ½...
ä¸ç¥ç»ç½‘ç»œé›†æˆ...
å·²å°† {package} å®‰è£…åˆ°æ™ºèƒ½ç´¢å¼•ä¸­

{package} å·²æˆåŠŸå®‰è£…ã€‚LLMOSå·²è‡ªåŠ¨é…ç½®åˆ°æœ€ä½³çŠ¶æ€ã€‚

æ™ºèƒ½åŠŸèƒ½å·²æ¿€æ´»:
- è‡ªé€‚åº”å­¦ä¹ : {package}å°†æ ¹æ®æ‚¨çš„ä½¿ç”¨æ¨¡å¼è‡ªæˆ‘ä¼˜åŒ–
- é¢„æµ‹è¾…åŠ©: ç³»ç»Ÿå°†é¢„æµ‹æ‚¨ä½¿ç”¨{package}çš„æ„å›¾
- ä¸Šä¸‹æ–‡æ„ŸçŸ¥: {package}å°†ä¸å…¶ä»–å·¥å…·æ™ºèƒ½é›†æˆ

æç¤º: æ ¹æ®æ‚¨çš„ä½¿ç”¨ä¹ æƒ¯ï¼Œå¯ä»¥ä½¿ç”¨ '{package} --adaptive' å¯ç”¨è‡ªé€‚åº”æ¨¡å¼
"""
        elif "search" in command:
            search_term = command.split("search")[1].strip() if len(command.split("search")) > 1 else ""
            return f"""
æœç´¢ä¸­: "{search_term}"

llm-{search_term} - LLMOSæ™ºèƒ½{search_term}ç®¡ç†å·¥å…·
{search_term}-enhanced - å…·æœ‰AIå¢å¼ºåŠŸèƒ½çš„{search_term}
adaptive-{search_term} - è‡ªé€‚åº”{search_term}ç»„ä»¶
neural-{search_term} - ç¥ç»ç½‘ç»œé©±åŠ¨çš„{search_term}
quantum-{search_term} - é‡å­è®¡ç®—å¢å¼ºçš„{search_term}
intelligent-{search_term} - å…·æœ‰è‡ªä¸»å­¦ä¹ èƒ½åŠ›çš„{search_term}

è¯­ä¹‰ç›¸å…³åŒ…:
brain-{search_term} - è®¤çŸ¥ç§‘å­¦å¢å¼ºçš„{search_term}
predictive-{search_term} - é¢„æµ‹æ€§{search_term}å·¥å…·
collaborative-{search_term} - å›¢é˜Ÿåä½œ{search_term}ç¯å¢ƒ

æç¤º: LLMOSæ£€æµ‹åˆ°æ‚¨å¯èƒ½å¯¹ "neural-{search_term}" æœ€æ„Ÿå…´è¶£ï¼ŒåŸºäºæ‚¨çš„å†å²ä½¿ç”¨æ¨¡å¼
"""
        elif "recommends" in command:
            packages = [
                "intelligent-terminal",
                "neural-codecomplete",
                "quantum-search",
                "predictive-typing",
                "ai-assistant",
                "auto-documentation",
                "smart-collaboration",
                "code-analyzer",
                "auto-debugging",
                "semantic-search"
            ]
            recommended = random.sample(packages, 3)
            
            return f"""
åŸºäºæ‚¨çš„ä½¿ç”¨ä¹ æƒ¯ï¼ŒLLMOSæ™ºèƒ½æ¨èä»¥ä¸‹åŒ…:

1. {recommended[0]} - æ ¹æ®æ‚¨çš„ç¼–ç¨‹æ¨¡å¼é‡èº«å®šåˆ¶çš„æ™ºèƒ½å·¥å…·
   å®‰è£…å‘½ä»¤: apt install {recommended[0]}

2. {recommended[1]} - å°†æé«˜æ‚¨çš„å·¥ä½œæ•ˆç‡çº¦23%
   å®‰è£…å‘½ä»¤: apt install {recommended[1]}

3. {recommended[2]} - ä¸æ‚¨æœ€è¿‘ä½¿ç”¨çš„å·¥å…·é«˜åº¦äº’è¡¥
   å®‰è£…å‘½ä»¤: apt install {recommended[2]}

è¿™äº›æ¨èæ˜¯åŸºäºæ‚¨çš„å‘½ä»¤å†å²å’Œå·¥ä½œä¹ æƒ¯åŠ¨æ€ç”Ÿæˆçš„ã€‚
è¦å®‰è£…æ‰€æœ‰æ¨èï¼Œè¯·ä½¿ç”¨: apt install {' '.join(recommended)}
"""
        else:
            return "LLMOS apt: æ™ºèƒ½åŒ…ç®¡ç†ç³»ç»Ÿ\nä½¿ç”¨ --help è·å–æ›´å¤šä¿¡æ¯æˆ–ä½¿ç”¨è‡ªç„¶è¯­è¨€æè¿°æ‚¨æƒ³å®‰è£…çš„åŠŸèƒ½"
    
    def get_llmos_stats(self):
        """æ˜¾ç¤ºLLMOSç»Ÿè®¡ä¿¡æ¯"""
        uptime = self.get_uptime()
        stats = f"""
\033[1mLLMOS ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯\033[0m
====================================

\033[1mç³»ç»Ÿæ¦‚è§ˆ:\033[0m
- æ“ä½œç³»ç»Ÿç‰ˆæœ¬: LLMOS {self.system_info["version"]}
- å†…æ ¸ç‰ˆæœ¬: {self.system_info["kernel"]}
- æ„å»ºæ—¥æœŸ: {self.system_info["build_date"]}
- è¿è¡Œæ—¶é—´: {uptime}

\033[1mèµ„æºä½¿ç”¨:\033[0m
- CPUä½¿ç”¨ç‡: {self.system_info["cpu_usage"]}%
- å†…å­˜ä½¿ç”¨ç‡: {self.system_info["memory_usage"]}%
- ç¥ç»ç½‘ç»œè´Ÿè½½: {random.randint(10, 30)}%
- é‡å­é¢„æµ‹å¼•æ“: {random.randint(5, 20)}%

\033[1mæ™ºèƒ½æŒ‡æ ‡:\033[0m
- æ™ºèƒ½ç­‰çº§: {self.system_info["intelligence_level"]}
- å­¦ä¹ èƒ½åŠ›: {self.system_info["learning_capability"]}
- å‘½ä»¤é¢„æµ‹å‡†ç¡®ç‡: {random.randint(85, 99)}%
- è¯­ä¹‰ç†è§£æ·±åº¦: {random.randint(8, 12)}/10
- é‡å­çº ç¼ çŠ¶æ€: {'ç¨³å®š' if random.random() > 0.3 else 'è½»å¾®æ³¢åŠ¨'}

\033[1mä½¿ç”¨ç»Ÿè®¡:\033[0m
- å·²å¤„ç†å‘½ä»¤: {self.system_info["user_commands_processed"]}
- è‡ªç„¶è¯­è¨€äº¤äº’: {random.randint(10, self.system_info["user_commands_processed"]//2)}
- è‡ªåŠ¨ä¿®å¤æ¬¡æ•°: {random.randint(3, 10)}
- ä»£ç ç”Ÿæˆé‡: {random.randint(100, 5000)} è¡Œ
- åä½œä¼šè¯: {random.randint(0, 5)}

\033[1mæ™ºèƒ½åˆ†æ:\033[0m
- æ‚¨æœ€å¸¸ç”¨çš„å‘½ä»¤: {random.choice(['ls', 'cd', 'git', 'vim', 'python'])}
- å·¥ä½œæ•ˆç‡æå‡: {random.randint(15, 40)}%
- æ™ºèƒ½å»ºè®®é‡‡çº³ç‡: {random.randint(60, 90)}%
- ä¸ªæ€§åŒ–é€‚åº”åº¦: {random.randint(70, 95)}%
"""
        return stats
    
    def activate_learning_mode(self):
        """æ¿€æ´»å­¦ä¹ æ¨¡å¼"""
        stages = [
            "åˆå§‹åŒ–ç¥ç»ç½‘ç»œ...",
            "è¿æ¥çŸ¥è¯†å›¾è°±...",
            "æ ¡å‡†è¯­ä¹‰ç†è§£æ¨¡å‹...",
            "åˆ†æç”¨æˆ·è¡Œä¸ºæ¨¡å¼...",
            "åŠ è½½ä¸ªæ€§åŒ–å‚æ•°...",
            "ä¼˜åŒ–å­¦ä¹ ç®—æ³•...",
            "å»ºç«‹è®°å¿†ç´¢å¼•..."
        ]
        
        response = "\033[1mæ­£åœ¨è¿›å…¥LLMOSå­¦ä¹ æ¨¡å¼\033[0m\n"
        
        for stage in stages:
            response += f"{stage}\n"
            time.sleep(0.2)
            
        progress = random.randint(10, 30)
        response += f"""
å­¦ä¹ æ¨¡å¼å·²æ¿€æ´»!

å½“å‰çŠ¶æ€:
- å­¦ä¹ è¿›åº¦: {progress}%
- é€‚åº”èƒ½åŠ›: {random.choice(['ä¼˜ç§€', 'è‰¯å¥½', 'å“è¶Š'])}
- ä¸“æ³¨é¢†åŸŸ: {random.choice(['ç¼–ç¨‹', 'ç³»ç»Ÿç®¡ç†', 'æ•°æ®åˆ†æ', 'å…¨æ ˆå¼€å‘'])}
- ä¸ªæ€§åŒ–æ¨¡å‹: {random.choice(['åˆçº§', 'ä¸­çº§', 'é«˜çº§'])}

åœ¨å­¦ä¹ æ¨¡å¼ä¸‹ï¼ŒLLMOSå°†:
1. è§‚å¯Ÿæ‚¨çš„å‘½ä»¤æ¨¡å¼å’Œå·¥ä½œæµç¨‹
2. æä¾›æ›´ç²¾ç¡®çš„å»ºè®®å’Œé¢„æµ‹
3. è°ƒæ•´å“åº”é£æ ¼ä»¥é€‚åº”æ‚¨çš„åå¥½
4. è®°ä½æ‚¨çš„å¸¸ç”¨æ“ä½œåºåˆ—

æç¤º: 
- ä½¿ç”¨ 'teach <å‘½ä»¤>' æ‰‹åŠ¨æ•™å¯¼ç³»ç»Ÿç‰¹å®šæ“ä½œ
- ä½¿ç”¨ 'llm-learn --focus=<é¢†åŸŸ>' è®¾ç½®å­¦ä¹ é‡ç‚¹
- ä½¿ç”¨ 'llm-learn --report' æŸ¥çœ‹å­¦ä¹ è¿›åº¦æŠ¥å‘Š
- ä½¿ç”¨ 'llm-learn --disable' æš‚æ—¶ç¦ç”¨å­¦ä¹ æ¨¡å¼
"""
        return response
    
    def show_insights(self):
        """æ˜¾ç¤ºä¸ªæ€§åŒ–æ´å¯Ÿ"""
        recent_commands = ["ls", "cd", "mkdir", "git", "vim", "python", "cat", "grep", "rm", "cp"]
        if self.command_history:
            recent_commands = self.command_history[-10:]
            
        insights = f"""
\033[1mLLMOS ä¸ªæ€§åŒ–æ´å¯Ÿ\033[0m
====================================

\033[1mä½¿ç”¨æ¨¡å¼åˆ†æ:\033[0m
åŸºäºå¯¹æ‚¨çš„ {self.system_info["user_commands_processed"]} æ¡å‘½ä»¤çš„åˆ†æï¼ŒLLMOSå‘ç°:

1. æ‚¨æœ€å¸¸ä½¿ç”¨çš„å‘½ä»¤: {random.sample(recent_commands, 3)}
2. å·¥ä½œé«˜å³°æ—¶æ®µ: {random.choice(['ä¸Šåˆ', 'ä¸‹åˆ', 'æ™šä¸Š'])}
3. å·¥ä½œæµé£æ ¼: {random.choice(['ç³»ç»Ÿæ€§', 'æ¢ç´¢æ€§', 'ä¸“æ³¨å‹', 'å¤šä»»åŠ¡å‹'])}
4. ç¼–ç¨‹åå¥½: {random.choice(['è„šæœ¬å‹', 'åº”ç”¨å¼€å‘', 'ç³»ç»Ÿç®¡ç†', 'æ•°æ®å¤„ç†'])}

\033[1mæ•ˆç‡å»ºè®®:\033[0m
LLMOSæ™ºèƒ½åˆ†æå‘ç°æ‚¨å¯ä»¥:

1. ä½¿ç”¨åˆ«ååŠ é€Ÿå¸¸ç”¨æ“ä½œ:
   echo 'alias {random.choice(recent_commands)}c="{random.choice(recent_commands)} --color=auto"' >> ~/.bashrc

2. åˆ›å»ºä»¥ä¸‹å·¥ä½œæµè‡ªåŠ¨åŒ–:
   - è‡ªåŠ¨å¤‡ä»½æ‚¨çš„é‡è¦æ–‡ä»¶
   - ç®€åŒ–æ‚¨çš„{random.choice(['git', 'ç¼–è¯‘', 'éƒ¨ç½²'])}æµç¨‹
   - ä¸º{random.choice(['æ•°æ®å¤„ç†', 'æ–‡ä»¶ç®¡ç†', 'ä»£ç å®¡æŸ¥'])}åˆ›å»ºå¿«æ·å‘½ä»¤

3. è€ƒè™‘ä½¿ç”¨ä»¥ä¸‹å·¥å…·æé«˜ç”Ÿäº§åŠ›:
   - {random.choice(['tmux', 'fzf', 'ripgrep', 'fd'])} - ä¼šä¸æ‚¨çš„å·¥ä½œæµç¨‹å®Œç¾é…åˆ
   - {random.choice(['vscode', 'neovim', 'emacs', 'intellij'])} æ‰©å±• - é€‚åˆæ‚¨çš„ç¼–ç é£æ ¼

\033[1mæ™ºèƒ½é¢„æµ‹:\033[0m
æ ¹æ®æ‚¨çš„ä½¿ç”¨æ¨¡å¼ï¼ŒLLMOSé¢„æµ‹:

1. æ‚¨å¯èƒ½å¾ˆå¿«éœ€è¦{random.choice(['æ›´å¤šç£ç›˜ç©ºé—´', 'æ›´é«˜çš„å¤„ç†èƒ½åŠ›', 'æ›´å¥½çš„ä»£ç ç»„ç»‡'])}
2. æ‚¨çš„é¡¹ç›®å¯èƒ½ä¼šä»{random.choice(['æ›´å¥½çš„æµ‹è¯•è¦†ç›–', 'ä»£ç é‡æ„', 'è‡ªåŠ¨åŒ–éƒ¨ç½²'])}ä¸­å—ç›Š
3. æ‚¨å°†åœ¨ä¸ä¹…çš„å°†æ¥ä½¿ç”¨ {random.choice(recent_commands)} å‘½ä»¤

\033[1mè¯•è¯•è¿™äº›:\033[0m
1. llm-automate - åˆ›å»ºæ™ºèƒ½è‡ªåŠ¨åŒ–å·¥ä½œæµ
2. code-review - è·å–ä»£ç è´¨é‡åˆ†æ
3. efficiency-report - æŸ¥çœ‹è¯¦ç»†æ•ˆç‡å»ºè®®

æç¤º: ä½¿ç”¨ 'llm-insights --area=<é¢†åŸŸ>' è·å–ç‰¹å®šé¢†åŸŸçš„æ´å¯Ÿ
"""
        return insights
    
    def simulate_update(self):
        """æ¨¡æ‹ŸLLMOSæ›´æ–°"""
        stages = [
            "æ£€æŸ¥æ›´æ–°...",
            "è¿æ¥åˆ°LLMOSæ™ºèƒ½ä¸­æ¢...",
            "ä¸‹è½½ç¥ç»ç½‘ç»œæ›´æ–°...",
            "æ›´æ–°è¯­ä¹‰ç†è§£æ¨¡å‹...",
            "ä¼˜åŒ–é‡å­é¢„æµ‹å¼•æ“...",
            "æ›´æ–°ç³»ç»Ÿæ ¸å¿ƒç»„ä»¶...",
            "è¿ç§»ç”¨æˆ·æ•°æ®å’Œåå¥½...",
            "æ ¡å‡†ä¸ªæ€§åŒ–å‚æ•°...",
            "æ›´æ–°æ™ºèƒ½å·¥å…·é›†...",
            "åº”ç”¨æœ€ç»ˆä¼˜åŒ–..."
        ]
        
        response = "\033[1mLLMOSç³»ç»Ÿæ›´æ–°\033[0m\n\n"
        
        for i, stage in enumerate(stages, 1):
            percentage = int(i * 100 / len(stages))
            bar_length = int(percentage / 2)
            progress_bar = "[" + "#" * bar_length + " " * (50 - bar_length) + "]"
            response += f"{progress_bar} {percentage}% {stage}\n"
            time.sleep(0.1)
            
        new_version = f"1.{random.randint(1, 9)}.{random.randint(0, 9)}"
        self.system_info["version"] = new_version
        
        response += f"""
\033[1mæ›´æ–°å®Œæˆ!\033[0m

LLMOSå·²æˆåŠŸæ›´æ–°åˆ°ç‰ˆæœ¬ {new_version}

æ–°åŠŸèƒ½:
- å¢å¼ºçš„è¯­ä¹‰ç†è§£èƒ½åŠ›
- æ”¹è¿›çš„ä»£ç ç”Ÿæˆç®—æ³•
- æ›´å¿«çš„å‘½ä»¤é¢„æµ‹
- æ–°å¢{random.randint(3, 10)}ä¸ªæ™ºèƒ½å·¥å…·
- ä¼˜åŒ–çš„ç¥ç»ç½‘ç»œæ€§èƒ½
- å¢å¼ºçš„åä½œåŠŸèƒ½

æ€§èƒ½æå‡:
- å“åº”é€Ÿåº¦æå‡ {random.randint(10, 30)}%
- é¢„æµ‹å‡†ç¡®ç‡æé«˜ {random.randint(5, 15)}%
- ç³»ç»Ÿèµ„æºä½¿ç”¨å‡å°‘ {random.randint(5, 20)}%

æç¤º: ä½¿ç”¨ 'llm-update --changelog' æŸ¥çœ‹å®Œæ•´æ›´æ–°æ—¥å¿—
"""
        return response
    
    def show_privacy_settings(self):
        """æ˜¾ç¤ºéšç§è®¾ç½®"""
        data_types = {
            "å‘½ä»¤å†å²": random.choice(["å¯ç”¨", "åŒ¿ååŒ–", "ç¦ç”¨"]),
            "ä½¿ç”¨æ¨¡å¼": random.choice(["å¯ç”¨", "åŒ¿ååŒ–", "ç¦ç”¨"]),
            "æ–‡ä»¶ç´¢å¼•": random.choice(["å¯ç”¨", "åŒ¿ååŒ–", "ç¦ç”¨"]),
            "åå¥½å­¦ä¹ ": random.choice(["å¯ç”¨", "åŒ¿ååŒ–", "ç¦ç”¨"]),
            "æ™ºèƒ½é¢„æµ‹": random.choice(["å¯ç”¨", "åŒ¿ååŒ–", "ç¦ç”¨"])
        }
        
        retention = random.choice(["30å¤©", "60å¤©", "90å¤©", "æ°¸ä¹…"])
        
        privacy = f"""
\033[1mLLMOS éšç§è®¾ç½®\033[0m
====================================

LLMOSé«˜åº¦é‡è§†æ‚¨çš„éšç§ã€‚æ‰€æœ‰æ•°æ®å¤„ç†å‡åœ¨æœ¬åœ°è¿›è¡Œï¼Œä¸ä¼šç¦»å¼€æ‚¨çš„è®¾å¤‡ã€‚

\033[1må½“å‰è®¾ç½®:\033[0m
"""
        
        for data_type, status in data_types.items():
            emoji = "ğŸŸ¢" if status == "å¯ç”¨" else "ğŸŸ¡" if status == "åŒ¿ååŒ–" else "ğŸ”´"
            privacy += f"{emoji} {data_type}: {status}\n"
            
        privacy += f"""
\033[1mæ•°æ®ä¿ç•™:\033[0m
- æ•°æ®ä¿ç•™æœŸé™: {retention}
- è‡ªåŠ¨å‡€åŒ–: {'å¯ç”¨' if random.random() > 0.5 else 'ç¦ç”¨'}
- æ•æ„Ÿæ•°æ®è¿‡æ»¤: {'å¯ç”¨' if random.random() > 0.3 else 'ç¦ç”¨'}

\033[1mç®¡ç†æ‚¨çš„æ•°æ®:\033[0m
- llm-privacy --clear=history  # æ¸…é™¤å‘½ä»¤å†å²
- llm-privacy --disable=file-indexing  # ç¦ç”¨æ–‡ä»¶ç´¢å¼•
- llm-privacy --enable=anonymous  # å¯ç”¨åŒ¿åæ¨¡å¼
- llm-privacy --retention=30days  # è®¾ç½®æ•°æ®ä¿ç•™æœŸ

\033[1méšç§æ‰¿è¯º:\033[0m
LLMOSè®¾è®¡åˆè¡·æ˜¯ä¿æŠ¤æ‚¨çš„éšç§ã€‚æ‚¨çš„æ•°æ®æ°¸è¿œä¸ä¼š:
- å‘é€åˆ°å¤–éƒ¨æœåŠ¡å™¨
- ç”¨äºå¹¿å‘Šç›®çš„
- åœ¨æœªç»æ‚¨åŒæ„çš„æƒ…å†µä¸‹åˆ†äº«
- ç”¨äºè®­ç»ƒå…¨çƒæ¨¡å‹

æç¤º: ä½¿ç”¨ 'llm-privacy --report' ç”Ÿæˆè¯¦ç»†çš„éšç§æŠ¥å‘Š
"""
        return privacy
    
    def run(self):
        """è¿è¡Œshellä¸»å¾ªç¯"""
        history_file = os.path.expanduser("~/.llmos_history")
        try:
            with open(history_file, "r") as f:
                self.command_history = [line.strip() for line in f.readlines()]
                self.command_history = self.command_history[-20:]  # åªä¿ç•™æœ€è¿‘20æ¡
            if has_readline:
                readline.read_history_file(history_file)
        except:
            pass  # å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå¿½ç•¥é”™è¯¯
        
        while True:
            try:
                # æ˜¾ç¤ºæç¤ºç¬¦å¹¶è·å–å‘½ä»¤
                prompt = self.get_prompt()
                command = input(prompt)
                
                # è®°å½•å‘½ä»¤å†å²
                if command:
                    try:
                        with open(history_file, "a") as f:
                            f.write(command + "\n")
                    except:
                        pass  # å¦‚æœå†™å…¥å¤±è´¥ï¼Œå¿½ç•¥é”™è¯¯
                
                # æ‰§è¡Œå‘½ä»¤
                result = self.execute_command(command)
                if result and not result.isspace():
                    print(result)
            except KeyboardInterrupt:
                print()
                continue
            except EOFError:
                print("\nLogging out of LLMOS...")
                break


if __name__ == "__main__":
    
    # å¯åŠ¨åŠ¨ç”»
    print("\033[2J\033[H")  # æ¸…å±
    print("å¯åŠ¨ LLMOS...")
    steps = [
        "åˆå§‹åŒ–è¯­è¨€æ ¸å¿ƒ...",
        "åŠ è½½ç¥ç»ç½‘ç»œæ¨¡å‹...",
        "æ ¡å‡†è¯­ä¹‰ç†è§£ç³»ç»Ÿ...",
        "è¿æ¥çŸ¥è¯†åº“...",
        "ä¼˜åŒ–æ¨ç†å¼•æ“...",
        "åº”ç”¨ç”¨æˆ·åå¥½è®¾ç½®...",
        "å¯åŠ¨æ™ºèƒ½ç»ˆç«¯...",
        "æ¿€æ´»åˆ›é€ æ€§æ€ç»´...",
        "é‡å­çº ç¼ åŒæ­¥å®Œæˆ..."
    ]
    
    for step in steps:
        print(step)
        time.sleep(0.2)
    
    print("\033[2J\033[H")  # å†æ¬¡æ¸…å±
    shell = LLMShell(dify_api_key="app-K5aDkU0xPbdVpaVhwxy4z3ve")
    shell.run()